Item(by='snuxoll', descendants=None, kids=None, score=None, time=1602546837, title=None, item_type='comment', url=None, parent=24760166, text='It should be an atomic replace - create a new table, do your inserts, swap the new table in. This way you aren’t left without the data during the rebuild, and you are guaranteed a consistent state since DDL is transactional in PostgreSQL.<p>Make the new table unlogged while it’s being populated as well for that performance improvement if you want, since the atomic replace guarantees your consistency anyway.<p>Alternative if it’s not a full rebuild, move from a delete&#x2F;insert to using INSERT .. ON CONFLICT DO UPDATE where possible. I do this for cache tables that store materialized summary views that are updated by pgAgent jobs.<p>If you are deleting “old” data out then maybe use partitioned tables so you can just DROP the table containing the data you want gone.')