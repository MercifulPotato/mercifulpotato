Item(by='dragontamer', descendants=None, kids=None, score=None, time=1603223302, title=None, item_type='comment', url=None, parent=24841627, text='It doesn&#x27;t work all the time. Sometimes its just faster to have thread-divergence than to hit VRAM constantly.<p>But its a different paradigm to do things: something to try if your standard if&#x2F;else stuff isn&#x27;t working out.<p>EDIT: If you can make due with just stack-allocation (or queue-allocation), if you have singular-sized tasks with predictable sizes, if all the information fits inside of __shared__ memory, and if thread-divergence is normally a problem... this methodology will probably work.<p>Oh, and for a hint:<p><pre><code>    myIdx = prefixSum(__activemask());\n    myTask = stack[stackTail + myIdx];\n    if(myIdx == 0){\n      stackTail -= __popc(__activemask()); &#x2F;&#x2F; Lulz, I made a bug. Whatever, I think you understand...\n    }\n    __syncThreads(); &#x2F;&#x2F; Barrier is important\n</code></pre>\nStack pops and pushes are pretty easy. activemask() provides your execution mask, and the logic needed to synchronously push &#x2F; pop items to a stack (and probably to more complicated memory allocation functions that I haven&#x27;t figured out yet)')