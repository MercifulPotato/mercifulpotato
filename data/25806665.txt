Item(by='vaduz', descendants=None, kids=[25808268, 25808105], score=None, time=1610840870, title=None, item_type='comment', url=None, parent=25805960, text='&gt; Sending your DNS queries to a resolver that you control is hardly MITM.<p>That&#x27;s if your users are well-behaved and follow the rules. To stop the users from being badly behaved, NSA recommends blocking connectivity to well-known IP addresses of the public DoH resolvers (e.g. Cloudflare) and TLS inspection to stop connections that try to go to less well known ones, including via ODoH, which means your TLS inspection device must understand the protocol.<p>To do TLS inspection at that level you need to MitM all HTTPS traffic going everywhere, as you need to read all HTTPS traffic to any possible host, as any of them may be a DoH resolver or relay. Q.E.D.')