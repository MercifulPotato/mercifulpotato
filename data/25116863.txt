Item(by='floatingatoll', descendants=None, kids=[25118202, 25117352], score=None, time=1605559984, title=None, item_type='comment', url=None, parent=25116540, text='macOS <i>packet</i> filtering in Big Sur is unchanged, offering src&#x2F;dst host&#x2F;port&#x2F;proto filters, as is typically thought of to be a &#x27;firewall&#x27;.<p>macOS <i>content</i> filtering in Big Sur is no longer able to intercept apps on the exclusion list shipped by Apple, and is akin to &#x27;iptables --uid 501&#x27; or &#x27;iptables --command firefox-bin&#x27; (actual syntax may vary).<p>The content filtering API can see which user&#x2F;app originated the traffic, as it&#x27;s running higher up in the stack; the packet filtering API cannot, as it&#x27;s running lower down in the stack.<p>Apps such as Little Snitch allow you to filter network traffic per-application, which can&#x27;t be done with PF; you need CF for that, and CF no longer extends to Apple core system processes in Big Sur.<p>Mullvad&#x27;s blocks are done imprecisely with PF (presumably they deny 17.0.0.0&#x2F;8), which is why their blocks break various functionality such as the Mac App Store or:<p>&gt; <i>For example, the keyboard sometimes takes longer to wake up from sleep mode. Or, in certain situations, the Mullvad app takes longer to detect that the computer is online.</i><p>And while they note that it&#x27;s possible to punch exceptions into the firewall, those exceptions can&#x27;t be granted per-use, only per-IP.')