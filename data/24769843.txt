Item(by='malkia', descendants=None, kids=[24771121], score=None, time=1602620193, title=None, item_type='comment', url=None, parent=24762840, text='For C++, I walked (halfway) the really long road of replacing std:: with std::pmr:: where I can, safely pluging jemalloc - and solve the performance issues we had with the standard heap allocator (Windows). But std::pmr::string now being 8 bytes bigger caused us slowdowns unexpectedly. Also tons of changes, different types, overall not great.<p>Then discovered mimalloc, which hooks at low-level malloc&#x2F;free, and at the same time a coworker also did similar job and now I&#x27;m no longer in love with &quot;pmr&quot;.<p>I wish it was success story, but it&#x27;s not. It probably is, if everyone is on board with it. But hardly this was my case. Also libraries are not - Qt is not, and many others.<p>pmr is great for things like - try to alloc on the stack, and if not enough continue with heap (under the hood), but the extra 8 bytes, and the fact that do_alloc is virtual call is problem (last one maybe not perf enough, but still hard to sell to performance oriented programmers).<p>I wish it was designed in way where it could&#x27;ve been sold as  such.')