Item(by='haberman', descendants=None, kids=None, score=None, time=1606161096, title=None, item_type='comment', url=None, parent=25190416, text='The latest optimized version of the protobuf parser does a remarkably similar thing:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;protocolbuffers&#x2F;protobuf&#x2F;blob&#x2F;master&#x2F;src&#x2F;google&#x2F;protobuf&#x2F;parse_context.h#L71-L106" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;protocolbuffers&#x2F;protobuf&#x2F;blob&#x2F;master&#x2F;src&#x2F;...</a><p>Protobufs are full of varints, and we want to perform only one bounds-check per field. So we ensure that the input buffer always has at least 16 bytes available to parse per field.  If there are fewer than 16 bytes remaining, we copy these last few bytes of data into a patch buffer and parse from that instead.')