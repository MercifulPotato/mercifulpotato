Item(by='netgusto', descendants=0, kids=None, score=1, time=1607087042, title='Ask HN: Is GitHub App authorization model sound?', item_type='story', url=None, parent=None, text='I&#x27;m in the process of building a website integrated around a GitHub App of mine.<p>There&#x27;s something in the GitHub App install process I cannot wrap my head around:<p>After a user installs my app:<p>* their browser is redirected to a URL (&quot;Post install Setup URL&quot;), with the install ID in the URL.<p>* GitHub calls my webhook to declare the install<p>The install ID is a sensible info, as if a malicious user of my website (the attacker) can trick my website into associating the GitHub Install ID of somebody else (the victim) with his own account on my website, my website would operate on the GitHub API of the victim on behalf of the attacker (which is bad!).<p>Now, my goal is to securely bind this install ID to the user of my website. By secure, I mean that it is impossible for my website to grant an attacker permissions on a victim GitHub install of my app.<p>Using the GitHub install ID provided in the &quot;Post install Setup URL&quot; to bind this install to an account of my website is insecure, as I have no way to validate that this install ID &quot;belongs&quot; to the user of my website, as the URL can be forged by an attacker knowing a valid install ID of a victim.<p>Imperfect mitigations:<p>* assert that the install ID is not bound to any other user account of my website<p><pre><code>    * bad as it could be circumvented if for some reason the legit user was never redirected to my website using the &quot;Post install Setup URL&quot; to bind this GitHub install ID to his account\n\n    * bad as in any case, this would be vulnerable to a &quot;race&quot; (or timing?) attack on the confirmation (if the attacker manages to confirm the valid install ID before the victim)\n</code></pre>\n* use in conjunction of a GitHub API Event event received on a webhook<p><pre><code>    * the webhook is triggered by the Github backend, and thus don&#x27;t know identify of the logged-in website user, which does not help us to bind github install ID to the proper website user.\n</code></pre>\nAm I missing something, or is this a flaw of the GitHub App model ?')