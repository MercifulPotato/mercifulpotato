Item(by='saagarjha', descendants=None, kids=None, score=None, time=1611919942, title=None, item_type='comment', url=None, parent=25955588, text='Please assume good faith–I am familiar with how the shared cache works and my comments apply equally to either the main executable or the shared cache. My point is that the shared cache is not very well randomized at all–for its size, the region it has to slide around in is fairly small. From the original blog post detailing the ASLR break (<a href="https:&#x2F;&#x2F;googleprojectzero.blogspot.com&#x2F;2020&#x2F;01&#x2F;remote-iphone-exploitation-part-2.html" rel="nofollow">https:&#x2F;&#x2F;googleprojectzero.blogspot.com&#x2F;2020&#x2F;01&#x2F;remote-iphone...</a>) the number of probes required to find the mapping is quite small, purely because it can only be located within a single 4 GB region for whatever reason. On a system with terabytes of virtual address space, this is a strange choice.<p>Oh, and because you mentioned it: yes, the shared cache has many objects in it. The process of making it <i>is</i> fairly involved, especially since many optimizations go into it (string deduplication, perfect hashing for Objective-C runtime metadata, shortening intra-cache procedure calls, …) But this is all done once when it is built by Apple&#x27;s B&amp;I, so it&#x27;s not a problem on-device.')