Item(by='tialaramex', descendants=None, kids=[24747254, 24746900, 24747212], score=None, time=1602431401, title=None, item_type='comment', url=None, parent=24746143, text='My preference is always to actually test parts in as close as possible to the real state, avoiding mocks unless they&#x27;re necessary. The more &quot;fake&quot; the system is, the less it tells you about how your software actually works.<p>So since I <i>could</i> generate collisions for the real hash, that&#x27;s what I did. If it had been infeasible, I would of course have found a different way to test.<p>This particular software was written mostly in C (today I would not write it in C) which makes it even more likely that introducing never-used-in-production behaviour unexpectedly perturbs the system. This same system for example ran into an obscure (and since fixed) libc allocator bug, and a defect in the Linux kernel, because we were really kicking the shit out of the memory mapped file I&#x2F;O with what we were doing.')