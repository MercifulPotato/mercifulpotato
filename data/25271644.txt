Item(by='dvt', descendants=None, kids=[25273495, 25271707, 25276710, 25271988], score=None, time=1606866661, title=None, item_type='comment', url=None, parent=25270184, text='I read the entire thing, and honestly the heap grooming is very interesting, but really that&#x27;s the boring part -- lots of trial and error, padding memory, etc. Also interesting that linked-lists aren&#x27;t used by Apple† (and Ian Beer&#x27;s suggestion that they <i>ought</i> to use them), but that&#x27;s neither here nor there. Getting kernel memory read&#x2F;write is also very interesting, albeit (again) a bit tedious. At the end of the day, it all started with this:<p>&gt; Using two MacOS laptops and enabling AirDrop on both of them I used a kernel debugger to edit the SyncTree TLV sent by one of the laptops, which caused the other one to kernel panic due to an out-of-bounds memmove.<p>How did this even pass the _smell_ test? How did it get through code reviews and auditing? You&#x27;re <i>allocating</i> from an <i>untrusted source</i>. It&#x27;s like memory management 101. I mean, my goodness, it&#x27;s from a <i>wireless</i> source, at that.<p>† In this specific scenario, namely the list of `IO80211AWDLPeer`s.')