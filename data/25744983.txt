Item(by='steerablesafe', descendants=None, kids=[25746040], score=None, time=1610448098, title=None, item_type='comment', url=None, parent=25742547, text='What a nasty bug! I would never have guessed that the order of stack-pointer arithmetic and operations on stack variables mattered. I wonder how much of the generated code must be &quot;pessimized&quot; to be interrupt-safe. This could be an actual pessimization if a section of code is only executed with interrupts turned off (I don&#x27;t know if this happens within the kernel).<p>How does this relate to user-space code? Could the same bug manifest is user-space code when handling signals? I don&#x27;t know much about how exactly signals are delivered and handled in user-space processes.<p>edit: Now that I think about it red zone in user-space pretty much assumes that the equivalent can&#x27;t happen there. It appears that red zone is disabled for the kernel precisely because of interrupts. I still wonder how signal handlers interact with the user-space thread&#x27;s stack.')