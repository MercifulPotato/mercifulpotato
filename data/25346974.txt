Item(by='azdle', descendants=None, kids=None, score=None, time=1607443237, title=None, item_type='comment', url=None, parent=25346677, text='Clearly Rust can&#x27;t solve all bugs, but I bet it would have prevented this one.<p>GENERAL_NAME[1] is a struct containing a type tag &quot;enum&quot; and a union of the data (d) for each type. If I&#x27;m reading it right the bug here is reading the union as &#x27;other&#x27; when the tag says its `GEN_EDIPARTY`.<p>In rust this would just be a fat enum where the variants of the enum would actually contain the data that this has in the union. Then the Rust compiler would only allow you to read the data as the type it&#x27;s stored as.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;openssl&#x2F;openssl&#x2F;blob&#x2F;13a574d8bb2523181f8150de49bc041c9841f59d&#x2F;include&#x2F;openssl&#x2F;x509v3.h.in#L137-L167" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;openssl&#x2F;openssl&#x2F;blob&#x2F;13a574d8bb2523181f81...</a>')