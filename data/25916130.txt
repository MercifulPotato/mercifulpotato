Item(by='lumost', descendants=None, kids=[25927247], score=None, time=1611671595, title=None, item_type='comment', url=None, parent=25913781, text='If you recognize that there isn&#x27;t a good automated solution for the DB to smartly join messages than it becomes a fairly straightforward problem once again.<p>e.g. the simple solution is to denormalize the table and have each message keyed by recipient.   In a dating app you&#x27;ll roughly double your message count this way, and even in most messenger apps the proportion of messages sent person to person is likely the most significant.<p>A smarter solution is to key each conversation by a unique key \nin a sharded table and then store the set of &quot;conversations&quot; that a user is engaged in in the sharded users table.  Fetching the messages for a user then becomes a simple 2 query process - fetch&#x2F;filter the conversations, then fetch the messages.  No duplication of messages, and likely just a few extra bytes per message for the key.<p>It would be great if the DB could manage the above application side sharded join internally, but we&#x27;re unfortunately a few steps away from that today.')