Item(by='krizhanovsky', descendants=None, kids=None, score=None, time=1604331705, title=None, item_type='comment', url=None, parent=24963551, text='I still don&#x27;t see any misconceptions. The reason why the kernel uses SIMD with FPU save&#x2F;restore is to optimize context switches. We addressed the topic in <a href="https:&#x2F;&#x2F;netdevconf.info&#x2F;0x12&#x2F;session.html?kernel-tls-handshakes-for-https-ddos-mitigation" rel="nofollow">https:&#x2F;&#x2F;netdevconf.info&#x2F;0x12&#x2F;session.html?kernel-tls-handsha...</a> . I guess early versions of WireGuard used the same approach: save FPU context at the beginning of softirq, process may packets with SIMD in one shot, and restore FPU state.<p>There are also other issues with the kernel code and I addressed them in the article, why it doesn&#x27;t makes sense (while still possible) to use C++ in the kernel code.')