Item(by='Spivak', descendants=None, kids=None, score=None, time=1604443742, title=None, item_type='comment', url=None, parent=24968841, text='Physical hardware failures are handled by having everything in VMs and storage handled by Ceph. We can lose plenty of physical boxes simultaneously before we run into capacity issues.<p>Multi-DC failover is handled by announcing our public IP block at both locations with different weights. Itâ€™s technically active&#x2F;active because traffic can come in at the secondary DC but we have a internal site-to-site VPN that is used to direct traffic to the primary. If the primary DC goes down the secondary starts handling the traffic instead of passing it along. All the database masters flip to the secondary and things keep humming along.<p>If we lose the site-to-site then the secondary stops advertising altogether and all traffic is forced to the primary.<p>So we can lose the site-to-site (which is dedicated) or one of the DCs at any time.')