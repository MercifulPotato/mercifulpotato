Item(by='ibobev', descendants=None, kids=None, score=None, time=1611764100, title=None, item_type='comment', url=None, parent=25902827, text='Does someone have any idea why latches do not have also count up operation alongside count down? In one of my previous jobs, I implemented a latch with a mutex, condition variable, and a counter and I supported also count up. It seems to work OK and count up was an essential operation for the use case I had needed it.<p><pre><code>    class ThreadLatch\n    {\n    public:\n        ThreadLatch(std::size_t count = 0)\n            : _count(count) {}\n\n        void inc()\n        {\n            std::lock_guard&lt;std::mutex&gt; lock(_mutex);\n            ++_count;\n        }\n\n        void dec()\n        {\n            std::lock_guard&lt;std::mutex&gt; lock(_mutex);\n            assert(0 != _count);\n            --_count;\n            if(0 == _count)\n            {\n                _condition.notify_all();\n            }\n        }\n\n        void wait()\n        {\n            std::unique_lock&lt;std::mutex&gt; lock(_mutex);\n            while(_count &gt; 0)\n            {\n                _condition.wait(lock);\n            }\n        }\n\n    private:\n        std::mutex _mutex;\n        std::condition_variable _condition;\n        std::size_t _count;\n    };</code></pre>')