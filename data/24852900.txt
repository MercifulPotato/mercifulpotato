Item(by='tptacek', descendants=None, kids=None, score=None, time=1603319012, title=None, item_type='comment', url=None, parent=24851826, text='For CDN purposes, you assume that <i>something</i> on each end of the TCP connection --- something outside of BPF --- is going to be running a full TCP. In our case, that something is Linux&#x27;s TCP&#x2F;IP stack running in a Firecracker VM (we could load XDP programs into our VMs, but we don&#x27;t).<p>You can do a lot with TCP, and be tolerant to out-of-order delivery and drops, just by shuttling the individual packets. So we can in fact &quot;cut through&quot; TCP sessions directly to Firecracker, avoiding our proxies. We don&#x27;t, though: our &quot;tcp&quot; handlers actually route through our Rust proxies, both because that&#x27;s what they&#x27;ve always done, and because in most cases there isn&#x27;t much of a win to bypassing the proxies, which have a lot more load balancing and resiliency logic than the BPF-based UDP data path does.')