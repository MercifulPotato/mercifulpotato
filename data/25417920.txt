Item(by='apankrat', descendants=None, kids=[25418045, 25418213, 25423603, 25418927], score=None, time=1607956208, title=None, item_type='comment', url=None, parent=25417211, text='Re: <i>Should object values be captured?</i><p><i>The results from 387 responses (to a Twitter poll) show a 2:1 preference for the value being read at the time the \ndeferred statements are executed (66.9%) rather than when the defer statement encountered(33.1%).</i><p>Since both options - by value and by reference - may be viewed as reasonable or desirable, neither should be a default. Instead, they both should be using a special syntax. So if you write something likes this -<p><pre><code>  guard {\n    void * p = malloc(...);\n    defer free(p);\n  }\n</code></pre>\nit simply won&#x27;t compile. Instead you&#x27;d need to say something like this -<p><pre><code>  guard {\n    void * p = malloc(...);\n    defer free(^p); &#x2F;&#x2F; evaluate now\n  }\n\n  guard {\n    void * p = malloc(...);\n    defer free(p^); &#x2F;&#x2F; evaluate later\n  }\n</code></pre>\nThis may also be reused later for specifying lambda captures... should lambdas ever make their way into C.')