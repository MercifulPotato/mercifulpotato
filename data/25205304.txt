Item(by='wahern', descendants=None, kids=[25206437], score=None, time=1606270817, title=None, item_type='comment', url=None, parent=25204283, text='I didn&#x27;t understand why the implementation wouldn&#x27;t just do an atomic increment, but I guess Obj-C semantics provide too much magic to permit such a simple approach. The actual code, in addition to [presumably] not being inlined, does not seem easy to optimize at the hardware level: <a href="https:&#x2F;&#x2F;github.com&#x2F;apple&#x2F;swift-corelibs-foundation&#x2F;blob&#x2F;main&#x2F;CoreFoundation&#x2F;Base.subproj&#x2F;CFRuntime.c#L1365" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;apple&#x2F;swift-corelibs-foundation&#x2F;blob&#x2F;main...</a><p>The native Swift retain (swift_retain above) seems to be <i>somewhere</i> inside this mess: <a href="https:&#x2F;&#x2F;github.com&#x2F;apple&#x2F;swift&#x2F;blob&#x2F;main&#x2F;stdlib&#x2F;public&#x2F;runtime&#x2F;HeapObject.cpp" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;apple&#x2F;swift&#x2F;blob&#x2F;main&#x2F;stdlib&#x2F;public&#x2F;runti...</a>')