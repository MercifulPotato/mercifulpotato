Item(by='forinti', descendants=None, kids=[25657588], score=None, time=1609936809, title=None, item_type='comment', url=None, parent=25656583, text='A few cool tricks I use with window functions:<p>1- To find blocks of contiguous values, you can use something similar to Gauss&#x27; trick for calculating arithmetic progressions: sort them by descending order and add each value to the row number. All contiguous values will add to the same number. You can then apply max&#x2F;min and get rows that correspond to the blocks of values.<p><pre><code>    select min(n), max(n) from (\n      select n, n+row_number() over (order by n desc) group\n      from numbers\n    )\n    group by group\n    order by 1\n</code></pre>\n2- You can use a window function with exponential&#x2F;logarithms in order to calculate the accumulated inflation for the last n months:<p><pre><code>    select date, inflation, (exp(accumulated)-1)*100 from (\n      select date, inflation, sum(ln(1+(inflation&#x2F;100))) over (order by date desc rows between current row and 11 following) as accumulated\n      from inflation\n    ) \n</code></pre>\n3- You can do all the paging in SQL (fetch page n of m) or simply add a column with the total number of rows (this often makes it easier to process the results).')