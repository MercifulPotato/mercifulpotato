Item(by='knorker', descendants=None, kids=[25277144, 25287322], score=None, time=1606917614, title=None, item_type='comment', url=None, parent=25275857, text='What&#x27;s the equivalent in rust of defer? E.g. this code in Go is buggy:<p>mu.Lock(); fmt.Print(someoneElsesObject);mu.Unlock();return<p>You <i>need</i> to get into the habit of writing:<p>mu.Lock(); defer mu.Unlock(); fmt.Print(someoneElsesObject);return<p>And this gets extra complicated by the fact that in Go defer runs at end of function, not end of scope. This makes every single for-loop that needs to lock anything hard to read and annoying to write.<p>for _, a := range stuff { if err:=func()error { mu.Lock();defer mu.Unlock(); return a.stuff()}(); err != nil {return err}}')