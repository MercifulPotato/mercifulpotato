Item(by='Taniwha', descendants=None, kids=[24855462, 24855089], score=None, time=1603325482, title=None, item_type='comment', url=None, parent=24846987, text='Sigh - people still don&#x27;t understand this ..... many (many .... many!) years ago I did my first Unix port (very early 80s) it was of V6 to the Vax, my code ran as a virtual machine under VMS - Unix kernel running in supervisor mode in place of the VMS&#x27;s shell. Ported the kernel and the C compiler at the same time (NEVER do this, it is hell).<p>Anyway I came upon this comment in the swap in code a bunch of times, never understand it, until I came to it from the right place and it was obvious - a real aha! moment.<p>So here&#x27;s the correct explanation - V6 was a swapping OS, only needed a rudimentary MMU, no paging. When you did a fork the current process was duplicated to somewhere else in  memory .... if you didn&#x27;t have enough spare memory the system wrote a copy of the current process to swap and created a new process entry pointing at the copy on disk as if it was swapped out and set that SSWAP flag. In the general swap-in code a new process would have that flag set, it would fudge the stack with that aretu, clear the flag and the &quot;return(1)&quot; would return into a different place in the code from where the swapin was called - that &#x27;1&#x27; that has &quot;has many subtle implications&quot; is essentially the return from newproc() that says that this is the new process returning from a fork. Interestingly no place that calls the swap in routine that&#x27;s returning (1) expects a return value (C had rather more lax syntax back then, and there was no void yet), it&#x27;s returned to some other place that had called some other routine in the fork path (probably newproc() from memory).<p>A lot of what was going on is tied up in retu()&#x2F;aretu() syntax, as mentioned in the attached article, it was rather baroque and depended heavily on hidden details of what the compiler did (did I mention I was porting the compiler at the same time ....) - save()&#x2F;restore() (used in V7) hadn&#x27;t been invented yet and that&#x27;s what was used there.')