Item(by='chucky_z', descendants=None, kids=[24805452], score=None, time=1602873412, title=None, item_type='comment', url=None, parent=24781057, text='This is really cool!<p>I&#x27;m curious why CTEs don&#x27;t seem to be getting used here?<p><pre><code>  SELECT\n  (\n    SELECT\n      (\n        t.data,\n        t.created_at\n      )::jsonb_x_timestamp\n    FROM\n      telemetries t\n    WHERE\n      server_id = &#x27;a0dcc312-0623-af60-4dc0-238301cc9bf8&#x27;\n      AND data ? &#x27;load_avg&#x27;\n      AND t.created_at &gt;= series.target\n      AND t.created_at &lt;= (series.target + INTERVAL &#x27;2592 seconds&#x27;)\n      LIMIT 1\n  )\n  FROM\n  (\n    SELECT\n      target\n    FROM\n      GENERATE_SERIES(\n        &#x27;2020-09-01 00:00:00&#x27;::timestamp,\n        &#x27;2020-09-15 23:59:59&#x27;::timestamp,\n        INTERVAL &#x27;2592 seconds&#x27;\n      ) target\n  ) series\n</code></pre>\nI&#x27;m curious on the performance of:<p><pre><code>  WITH series AS SELECT\n    target\n  FROM\n  GENERATE_SERIES(\n    &#x27;2020-09-01 00:00:00&#x27;::timestamp,\n    &#x27;2020-09-15 23:59:59&#x27;::timestamp,\n    INTERVAL &#x27;2592 seconds&#x27;\n  ) target\n  SELECT\n  (\n    t.data,\n    t.created_at\n  )::jsonb_x_timestamp\n  FROM\n    telemetries t\n  WHERE\n    server_id = &#x27;a0dcc312-0623-af60-4dc0-238301cc9bf8&#x27;\n    AND data ? &#x27;load_avg&#x27;\n    AND t.created_at &gt;= series.target\n    AND t.created_at &lt;= (series.target + INTERVAL &#x27;2592 seconds&#x27;)\n  LIMIT 1\n</code></pre>\nor even shuffling some of the other selects and chaining CTEs together.  I&#x27;m even curious if you could somehow use a combination of CTEs to generate something more suitable for use with SYSTEM_ROWS (TIL!!  will keep this in my pocket for the future!).<p>CTEs are never a guarantee for performance improvements (they make things worse at times) but I see them getting ignored a lot when at times they are a huge boost.<p>Edit: wow the formatting is really bad, hopefully the code stuff doesn&#x27;t kill it for mobile users')