Item(by='avianes', descendants=None, kids=None, score=None, time=1605575132, title=None, item_type='comment', url=None, parent=25118797, text='&gt; There are many issues in determining what is code, where are the branch destinations in case of indirect branches, etc.<p>Yes, handling indrect branch seems a bit complex and I&#x27;m not a specialist in the field.\nBut I&#x27;m pretty sure that the cases of indirect branch are rare enough so that an additional indirection is relatively inexpensive.\nAdding a simple address mapping table should meet most of the cases.<p>An interesting question would also be whether Apple has added features to the hardware to improve the translation?<p>We know, for example, that Apple introduced a special register [1] to temporarily switch from the ARM consistency model to the TSO consistency model (Total Store Order) from x86.<p>[1] : <a href="https:&#x2F;&#x2F;github.com&#x2F;saagarjha&#x2F;TSOEnabler" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;saagarjha&#x2F;TSOEnabler</a>')