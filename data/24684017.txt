Item(by='BeeOnRope', descendants=None, kids=[24685704], score=None, time=1601865106, title=None, item_type='comment', url=None, parent=24683972, text='&gt; That seems very strange!<p>One way of thinking about it is that in arithmetic modulo M you can add or subtract any number of M terms without changing the result.<p>So x and M + x and 2M + x are all the same.<p>So 2^64 - s is the same as 2^64 - s - 2^64 = -s.<p>&gt; Also, there&#x27;s still a modulo in there<p>Yes, but it is guarded by the earlier check, so is executed only rarely (<i>very</i> rarely for most moderate range values &lt;&lt; 2^64).<p>IMO this is half of key insight that makes Lemire&#x27;s approach fast: that the modulo can be avoided most of the time by the coarser check and for wide (e.g., 2^64) input values, this means the modulo might as well not exist, performance-wise.')