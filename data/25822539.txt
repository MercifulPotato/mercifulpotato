Item(by='ignoramous', descendants=None, kids=[25822590], score=None, time=1610983013, title=None, item_type='comment', url=None, parent=25821718, text='One of the coolest XOR tricks I&#x27;ve seen is fast encoding of negative integers to positive integers (unsigned) employed by ProtoBufs. It is called ZigZag encoding where negative and positive integers are interleaved such that lower negative values are assigned to lower positive values:<p><pre><code>  input    zz(int)\n    0        0\n    1        2\n    2        4\n    3        6\n   -1        1\n   -2        3\n\n\n  zz(n int64)   =&gt; (n &lt;&lt; 1) ^ (n &gt;&gt; 63)  \n  \n  unzz(n int64) =&gt; (n &gt;&gt; 1) ^ (-(n &amp; 0x1))\n</code></pre>\n<a href="https:&#x2F;&#x2F;developers.google.com&#x2F;protocol-buffers&#x2F;docs&#x2F;encoding?csw=1#types" rel="nofollow">https:&#x2F;&#x2F;developers.google.com&#x2F;protocol-buffers&#x2F;docs&#x2F;encoding...</a><p>Edit: Fixed <i>unzz</i>, ref: <a href="https:&#x2F;&#x2F;github.com&#x2F;lemire&#x2F;FastIntegerCompression.js&#x2F;blob&#x2F;033768f72&#x2F;FastIntegerCompression.js#L44-L46" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;lemire&#x2F;FastIntegerCompression.js&#x2F;blob&#x2F;033...</a>')