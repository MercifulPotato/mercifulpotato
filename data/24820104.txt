Item(by='jcranmer', descendants=None, kids=None, score=None, time=1603046483, title=None, item_type='comment', url=None, parent=24818959, text='&gt;     &#x2F;<i>what if the file is deleted here?</i>&#x2F;<p>Nothing. In all major operating systems I&#x27;m aware of, opening a file creates a handle to the file contents. This handle is distinct from the handle implied by the existence of the path in the filesystem. Some filesystems allow you to create another handle to the same file by a different name (called a hardlink). Removing a file only deletes the handle implied by the path; if another handle to it exists (via a hardlink or the file currently being open in a process) the data itself is unaltered.<p>In general, TOCTTOU attacks are caused by introspection being done on paths instead of file handles. Once you have handles, and you are querying exclusively using handles, your TOCTTOU issues largely go away. There is still a related issue that filesystem atomicity guarantees (or rather, a general lack thereof) is still a major headache, but it&#x27;s not the same issue as TOCTTOU attacks.')