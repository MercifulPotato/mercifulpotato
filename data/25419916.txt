Item(by='jstimpfle', descendants=None, kids=[25420582], score=None, time=1607965542, title=None, item_type='comment', url=None, parent=25418730, text='Workaround:<p><pre><code>    #define LOCK(mutex) lock lock##__LINE__(mutex)\n</code></pre>\nOr even C compatible scoped locks:<p><pre><code>    #define SCOPED_LOCK(mutex) \\\n        for (int i##__LINE__ = lock_mutex(mutex), 1; \\\n                 i##__LINE__ --; \\\n                 unlock_mutex(mutex))\n</code></pre>\nUse like<p><pre><code>    SCOPED_LOCK(foo-&gt;mutex) {\n        do_stuff();\n    }</code></pre>')