Item(by='contravariant', descendants=None, kids=None, score=None, time=1603494044, title=None, item_type='comment', url=None, parent=24864809, text='Your code contains a small bug, in the leapfrog HMC function the line pnext = -p should be pnext = -pnext. Also this line is only of theoretical importance, it has no effect on the final result (unless you use a weird asymmetric kinetic energy).')