Item(by='spijdar', descendants=None, kids=None, score=None, time=1606037657, title=None, item_type='comment', url=None, parent=25175433, text='For more background, see <a href="https:&#x2F;&#x2F;developer.apple.com&#x2F;library&#x2F;archive&#x2F;documentation&#x2F;Darwin&#x2F;Conceptual&#x2F;KernelProgramming&#x2F;Architecture&#x2F;Architecture.html" rel="nofollow">https:&#x2F;&#x2F;developer.apple.com&#x2F;library&#x2F;archive&#x2F;documentation&#x2F;Da...</a><p>There it clarifies that it is &quot;mostly&quot; FreeBSD. The Mach being used also differs significantly from CMU Mach and what you might find by looking for Mach3&#x2F;4 source dumps.<p>One of the biggest challenges in &quot;converting&quot; NeXTSTEP (MacOS&#x27;s predecessor) to OS X was both updating software to newer versions and eliminating expensive licenses from AT&amp;T and Adobe.<p>NeXTSTEP was a &quot;capital U&quot; UNIX with AT&amp;T proprietary code, based on 4.3&#x2F;4.4BSD (encumbered). Every copy needed a UNIX license and royalties to AT&amp;T.<p>NeXT was based on Mach2, which had 4.3BSD deeply integrated into the kernel source tree. Device drivers were both native BSD ones along with a &quot;DriverKit&quot; interface that used Mach messages to write userland device drivers.<p>CMU Mach v3 and v4 cut out all the BSD code and put it into a userland &quot;UX Server&quot;, a model incompatible with NeXT. So instead, Apple took the OSF&#x2F;1 Mach kernel, derived from Mach 2.5, and replaced the BSD subsystem code with 4.4BSD-lite, gradually updating its subsystems with FreeBSD ones.<p>So TLDR, Darwin&#x2F;XNU has both a BSD userland and essentially a FreeBSD kernel. When you make a &quot;UNIX-y&quot; syscall from C in MacOS, you&#x27;re &quot;talking&quot; to a &quot;FreeBSD kernel&quot;.')