Item(by='comex', descendants=None, kids=None, score=None, time=1608763691, title=None, item_type='comment', url=None, parent=25522369, text='The chain of trust on macOS isâ€¦ complicated.  Too complicated.  Apple binaries are validated in at least <i>three</i> different ways:<p>1. By the kernel using a root certificate hardcoded into the CoreTrust kext;<p>2. On Apple Silicon only, by the kernel using a trust cache that&#x27;s supplied to the kernel by the bootloader;<p>3. By userland (amfid) using a root certificate hardcoded into Security.framework.<p>You&#x27;d have to modify or intercept all of those things, and key components aren&#x27;t open source (e.g. the AppleMobileFileIntegrity kext which is responsible for querying CoreTrust, the trust cache, and amfid).  Probably best to do some targeted function hooking rather than recompiling anything.<p>Of course, you would still have to turn off Secure Boot in order to load a modified kernel in the first place.  But that&#x27;s largely orthogonal to SIP.')