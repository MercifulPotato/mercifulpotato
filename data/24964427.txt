Item(by='shawnz', descendants=None, kids=None, score=None, time=1604285239, title=None, item_type='comment', url=None, parent=24964292, text='Maybe you can solve it like this: internally represent the document as DOM objects. Have element nodes contain a list of children which can be either raw strings (representing text nodes), or other element node objects. The render function of element nodes would know to escape the contents of text nodes before concatenating them with their rendered element node siblings. It would be type safe since it knows all the types of children it can contain.<p>It&#x27;s like SQL parameterized queries: delay the concatenation until the last possible moment to reduce the area where errors can occur.<p>But I think maybe that just moves the opportunity for error to the render function, so I don&#x27;t know if that is really an improvement on &quot;smart constructors&quot;.')