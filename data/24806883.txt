Item(by='cosmie', descendants=None, kids=[24807632], score=None, time=1602899972, title=None, item_type='comment', url=None, parent=24806464, text='&gt; Does M-code serve as a replacement for (the abysmal) VBA?<p>Sort of depends. M (and PowerQuery in general) is fundamentally about data processing. If you were only dropping into VBA for ETL purposes, then chances are you can use PowerQuery&#x2F;M instead. With the advantage that it exists in a standard xlsx file, rather than the macro-enabled xlsm files that are more heavily restricted in many environments. It&#x27;s not intended for more general purpose tasks, nor can it do stuff like interact with the Excel object model directly, so you&#x27;d still need to use VBA (or if targeting Excel 2016 and above, Javascript[1]) for that.<p>PowerQuery&#x2F;M is basically a sidecar app within Excel, and doesn&#x27;t have access to nor is aware of the Excel object model. Excel.CurrentWorkbook[2] is just a convenience function available when used within Excel, and it treats data from the current workbook the same as if it was pulling from an external workbook or csv file or web API or any other source. To the extent that even when solely accessing data from within the same workbook and not calling out externally at all, it prompts users with an &quot;Enable External Connections&quot; warning to use. You can then either have the output of that sync to a Table object within Excel (and easily&#x2F;generally available for use), or made available from within the data model (only available via the object model or pivot tables).<p>That said, the data access functions[3] are fairly expansive, and you can get pretty creative in how you (ab)use them. For example, Web.Action is one I&#x27;ve abused often: pinging a web service to track usage, triggering external jobs, and exporting&#x2F;syncing data to an external service. Although those last two uses require a bit of complexity in architecting, to account for cases when it gets manually refreshed&#x2F;triggered in quick succession or with duplicate data.<p>&gt; And how similar is it to F#?<p>I&#x27;m not familiar enough with F# to be able to answer that. But if you are, you can probably find out pretty quickly via this[4] article series. PowerQuery&#x2F;M is used across a variety of Microsoft products, and most resources around it are akin to product-specific &quot;how-tos&quot;. Ben&#x27;s primer series is the only source I&#x27;ve come across that approaches it from a software engineering perspective.<p>[1] <a href="https:&#x2F;&#x2F;docs.microsoft.com&#x2F;en-us&#x2F;office&#x2F;dev&#x2F;add-ins&#x2F;reference&#x2F;overview&#x2F;excel-add-ins-reference-overview" rel="nofollow">https:&#x2F;&#x2F;docs.microsoft.com&#x2F;en-us&#x2F;office&#x2F;dev&#x2F;add-ins&#x2F;referenc...</a><p>[2] <a href="https:&#x2F;&#x2F;docs.microsoft.com&#x2F;en-us&#x2F;powerquery-m&#x2F;excel-currentworkbook" rel="nofollow">https:&#x2F;&#x2F;docs.microsoft.com&#x2F;en-us&#x2F;powerquery-m&#x2F;excel-currentw...</a><p>[3] <a href="https:&#x2F;&#x2F;docs.microsoft.com&#x2F;en-us&#x2F;powerquery-m&#x2F;accessing-data-functions" rel="nofollow">https:&#x2F;&#x2F;docs.microsoft.com&#x2F;en-us&#x2F;powerquery-m&#x2F;accessing-data...</a><p>[4] <a href="https:&#x2F;&#x2F;bengribaudo.com&#x2F;blog&#x2F;2017&#x2F;11&#x2F;17&#x2F;4107&#x2F;power-query-m-primer-part1-introduction-simple-expressions-let" rel="nofollow">https:&#x2F;&#x2F;bengribaudo.com&#x2F;blog&#x2F;2017&#x2F;11&#x2F;17&#x2F;4107&#x2F;power-query-m-p...</a>')