Item(by='dspillett', descendants=None, kids=None, score=None, time=1610456053, title=None, item_type='comment', url=None, parent=25739903, text='The app-level keep alive will work for a while, probably a long while, but could still fail if there are enough connections using the method and the CGNAT routed has too few source addresses to map thing to. If the router needs to find some ports to use for new connections, and there are no apparently idle connections to throw out, it has few choices:<p>1. Just stop making new connections until some ports are freed. That&#x27;ll make people happy...<p>2. Kill the connections that have least recently seen activity even if they have sent&#x2F;received packets within the usual timeout.<p>3. Kill the longest running connections that aren&#x27;t from a whitelist of target ports like 80 &amp; 443 (P2P and VPN systems will just reconnect, the user will hopefully see no more than a short blip SSH will not fair so well).')