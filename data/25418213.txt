Item(by='knome', descendants=None, kids=None, score=None, time=1607957715, title=None, item_type='comment', url=None, parent=25417920, text='It would be easier to execute the argument expressions immediately, as golang does.<p>If they add this, it would be better to restrict it to the current scope, to avoid forcing the language to create complexity to handle defers created via loop in the background.<p>Of course, that leads to the question of what to do when you loop over a defer with a goto, which would make sense if you were constantly appending function pointers and arguments to the frame similar to alloca.<p>That could lead to fun things like a function getting inlined into a for loop and then having its defers that would have been in function instead piled together to blow the stack.<p>They&#x27;ll have to make sure they account for that in the spec and implementations.<p>Mostly, it would be easier to remember that C should not be using such a pattern, and that if you have need of defers and various similar magic to be baked into the language and compiler, what you&#x27;re doing is probably inappropriate for implementation in the C language in the first place.')