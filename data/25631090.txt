Item(by='andi999', descendants=None, kids=None, score=None, time=1609767312, title=None, item_type='comment', url=None, parent=25629927, text='I hope I remember these things correct. Let&#x27;s assume you have two 3D arrays and you want to form the point wise product and sum over the middle index, you can probably write sum(a*b, 1). Anything more complicated there is numpy einsum (check it out) <a href="https:&#x2F;&#x2F;numpy.org&#x2F;doc&#x2F;stable&#x2F;reference&#x2F;generated&#x2F;numpy.einsum.html" rel="nofollow">https:&#x2F;&#x2F;numpy.org&#x2F;doc&#x2F;stable&#x2F;reference&#x2F;generated&#x2F;numpy.einsu...</a>\nLetme know how these things can be nicely done in Matlab. \nOne problem I had in Matlab is some vectorization requires to  permute the indices, but this is expensive if your array is hundreds of megabyte.')