Item(by='segfaultbuserr', descendants=None, kids=None, score=None, time=1610624943, title=None, item_type='comment', url=None, parent=25774795, text='A funny malware exploit I&#x27;ve recently seen was this one...<p><a href="https:&#x2F;&#x2F;mastodon.social&#x2F;@slipstream&#x2F;99116564964787956" rel="nofollow">https:&#x2F;&#x2F;mastodon.social&#x2F;@slipstream&#x2F;99116564964787956</a><p>&gt; So, there&#x27;s a Chinese botnet package known as &quot;Destroyer&quot; (破坏者). It, ironically, can itself be destroyed, thanks to a stack buffer overflow. I wasn&#x27;t able to get full RCE, but a jump to &quot;call ExitProcess&quot; should be enough, no? It can be triggered directly after &quot;start DDoS&quot;, for even more lulz.<p>&gt; Here&#x27;s the exploit: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;Wack0&#x2F;d0aa7f56d5d044fb918056207d2149b1" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;Wack0&#x2F;d0aa7f56d5d044fb918056207d2149...</a><p>&gt; The C2 for this shitty chinese skiddie ddos-botnet has a stack buffer overflow in the parsing of packet opcode 3. This opcode is used for sending ddos-stats, so it only works when a packet with opcode 6 (start-ddos) is sent to us.<p>&gt; Unfortunately, two addresses are written to before returning; these addresses get clobbered, and the C2 binary is compiled with an ancient compiler (VC++6 lol). No null bytes, so we can only overwrite two addressses, one of which has to be the return address... We can get eip control via SEH, but the full packet buffer is too far away on the stack for us to be able to jump to a ROP chain :(<p>&gt; So the best we can do here is return to &quot;call ExitProcess&quot;, at least there the bots are neutered enough to be absolutely useless... (there&#x27;s additional functionality in the bot, but it seems the C2 that i have has no UI to send those packets lol)<p>&gt;  So, exploitation: (1) connect to C2. (2) send initial (system info) packet, this includes OS info string (we provide the string sent for &quot;unknown OS&quot; here), and CPU info (number of CPUs + CPU speed), we provide the specs of the highest-range Ryzen Threadripper here, because we can. (3) wait for packet 6 (start ddos) to be sent to us. (4) send our evil packet 3. (5) ??? (6) C2 killed :)')