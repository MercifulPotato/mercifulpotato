Item(by='KMag', descendants=None, kids=None, score=None, time=1605008693, title=None, item_type='comment', url=None, parent=25038211, text='On a side note, there was a workaround found for the backdoor: since it was using DH key agreement without digital signatures, both sides could use proxies that each generated a secret w, raised the outgoing DH public key to the power of w, and raised the incoming DH public key to the same power w.  Alice&#x27;s public key is g^x, where x is known to the government but is otherwise locked away deep in tamper-resistant hardware in the Clipper chip.  Alice&#x27;s proxy raises her (g^x)^w mod p = g^(x<i>w) mod p before it hits the wire.  Likewise, Bob&#x27;s proxy raises (g^y)^v mod p = g^(y </i> v) mod p.  Alice&#x27;s proxy raises Bob&#x27;s seen public key to her secret exponent g^(y * v)^w mod p = g^(y * v * w) mod p before sending it to her clipper chip, and the tamper-resistant hardware calculates g^(y * v * w) ^ x mod p = g^(x * y * w * v) mod p.  Bob&#x27;s clipper chip likewise is given 9^(x * w)^v mod p and calculates g^(x * w)^v^y mod p = g^(x * y * w * v) mod p.  Both chips calculate the same shared secret Skipkack key to encrypt the keystream.  A government wiretapper knows x and y and sees g^(xw) and g^(yv), but can&#x27;t calculate g^(xywv) unless they can compute discrete logarithms mod p.  As a bonus, they&#x27;d get perfect forward secrecy whereas fixed DH public keys don&#x27;t provide forward secrecy.<p>Authentication worked by the phone displaying a hash of the session key, and the two users were expected to read the key hash to each other and recognize each other&#x27;s voices.  If they were being MitM&#x27;d, they wouldn&#x27;t have identical session keys.  Alice and Bob&#x27;s authentication procedure would then still work just fine, since they&#x27;d still have identical session keys.<p>If the government were wiretapping Alice, they&#x27;d of course detect the tampering because they&#x27;d be getting garbage data&#x2F;failed checksums, but otherwise, the tampering would be undetectable, and Alice and Bob get hardware-accelerated 80-bit Skipjack encryption of their data stream, back when 56-bit DES was generally considered reasonably safe and 80-bit symmetric keys were considered sufficient for data classified SECRET and below.<p>(Or maybe the tampering could be detected when the wiretappers went to look up Alice&#x27;s fixed DH public key and couldn&#x27;t find it in their escrow database... I forget if the escrow worked by having a database or if the chip encrypted the DH secret key with a master key and transmitted it at the start of every session.  In any case, the whole thing wasn&#x27;t that well thought out.  It&#x27;s also possible the DH exchange was signed using a malleable signature scheme using the same prime as DH, allowing Alice to raise the DH public key to a known-only-to-Alice power and calculate the power needed to raise the signature in order to still get a valid signature on the modified DH public key.  Clearly, I forget the exact details.)')