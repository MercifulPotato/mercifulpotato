Item(by='hardwaresofton', descendants=None, kids=None, score=None, time=1602732372, title=None, item_type='comment', url=None, parent=24781453, text='Company aside, in a weird coincidence I recently came across an interesting slide deck from a meetup (?) here:<p><a href="https:&#x2F;&#x2F;speakerdeck.com&#x2F;takutakahashi&#x2F;ceph-on-zfs" rel="nofollow">https:&#x2F;&#x2F;speakerdeck.com&#x2F;takutakahashi&#x2F;ceph-on-zfs</a><p>I was impressed when I found this slide deck and it was in japanese, and from a thoroughly japanese company here. If you don&#x27;t happen to know japanese, just go like... 3 slides in and you can see the creator is from GMO, also there are some images.<p>If you&#x27;re not into infra you might as well stop reading here, but basically the idea is to get durable crash-resistant replicated storage on kubernetes by actually combining <i>two</i> CSI storage providers:<p>- Run ZFS as your on-disk file system (for absolute durability without bitrot and some of the other benefits) for each node<p>- Add the openebs&#x2F;zfs-localpv[0] to dynamically provision zvols with say xfs or ext4 to make drives for ceph to consume<p>- Add Ceph via Rook[1] to get synchronous remote replication on every write (if you want it), and give ceph the drives you made (the zvol(s))<p>- Expose storage to your kubernetes cluster that is replicated (depending on how you set up ceph) and easy to back up and&#x2F;or duplicate at the node level (w&#x2F; zfs send). You can back up at multiple levels, nodes themselves (with some replication lag since zfs doesn&#x27;t so sync replication) and the workloads that run on them (which are sync replicated across the network).<p>There is some overlap in these tools -- ceph&#x27;s relatively new bluestore engine does checksumming now and self-heals, so there&#x27;s not so much reason to use ZFS at the lowest level at all, but ZFS does have some features that ceph doesn&#x27;t, and is somewhat easier to manage with less moving parts in user space.<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;openebs&#x2F;zfs-localpv&#x2F;" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;openebs&#x2F;zfs-localpv&#x2F;</a><p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;rook&#x2F;" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;rook&#x2F;</a>')