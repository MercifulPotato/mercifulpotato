Item(by='dkarp', descendants=None, kids=[24778306], score=None, time=1602691662, title=None, item_type='comment', url=None, parent=24776771, text='Something really useful I recently discovered is multi-stage Dockerfiles. Using <i>FROM</i> and then <i>COPY --from</i> to copy from a previous stage to prevent unwanted intermediate build steps that might expose secrets or just bloat your images.<p>Two ways this was useful for us. Firstly, we needed a private key in the image to pull some private git repos. By doing this in a previous stage, they&#x27;re not included in the final image layers. Secondly, we have a python backend and small react app served from the same image. By splitting their build steps into a <i>backend</i> and <i>frontend</i> stage, changes to frontend code don&#x27;t break caching for the later backend steps or vice versa. E.g.<p><pre><code>  FROM python:3.8.3-slim-buster AS frontend\n  # Do frontend build steps\n  FROM python:3.8.3-slim-buster AS backend\n  # Do backend build steps\n  FROM python:3.8.3-slim-buster AS final\n  COPY --from=frontend &#x2F;app &#x2F;app&#x2F;frontend\n  COPY --from=backend &#x2F;app &#x2F;app&#x2F;backend</code></pre>')