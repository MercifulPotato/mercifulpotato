Item(by='mskslal', descendants=None, kids=[25419995, 25418353, 25418585, 25419993, 25423613, 25418624, 25418586, 25420053], score=None, time=1607957537, title=None, item_type='comment', url=None, parent=25417211, text='In its current form, this is really stupid, because of something like this:<p><pre><code>    guard {\n        for (int i = 0; i &lt; n; i++) {\n            defer foo(i);\n        }\n    }\n</code></pre>\nNow the compiler has to:<p>1. implement some side of capture&#x2F;closure mechanism to keep all the &#x27;i&#x27;s to the end of the guard block<p>2. do dynamic allocation to store the closures so they can be executed at the end did the scope<p>1 seems like too much work for such a feature, and 2 is a massive no. Implicit dynamic allocation, in C?<p>And all of this for nothing. The guard syntax doesn&#x27;t give any reasonable benefits. They should have just kept it simple; defer happens at the end of the scope, and it just takes &#x27;i&#x27; by &quot;reference&quot;. It&#x27;s a shame because it&#x27;s a feature I would really like to have.')