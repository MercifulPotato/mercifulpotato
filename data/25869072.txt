Item(by='gorgoiler', descendants=None, kids=None, score=None, time=1611297636, title=None, item_type='comment', url=None, parent=25862158, text='If LUKS could store a piece of random public data in the LUKS header then LUKS keys could be derived by signing that public data.<p>For example, ssh-agent can sign arbitrary data via its wire protocol.  Lots of USB security keys expose their functionality via ssh-agent.<p><a href="https:&#x2F;&#x2F;tools.ietf.org&#x2F;html&#x2F;draft-miller-ssh-agent-04" rel="nofollow">https:&#x2F;&#x2F;tools.ietf.org&#x2F;html&#x2F;draft-miller-ssh-agent-04</a><p>Does LUKS &#x2F; cryptsetup provide hooks for deriving a key from a blob of plaintext stored on the disk?<p>[edit] There’s the UUID — sign it with your ssh-agent and use the hexdigest as a LUKS key.  It sounds so simple it must already exist?')