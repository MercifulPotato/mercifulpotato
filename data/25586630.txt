Item(by='haberman', descendants=None, kids=[25587151, 25590325], score=None, time=1609365420, title=None, item_type='comment', url=None, parent=25586455, text='&gt; Things may have changed since, but AFAIK the C++ implementation would always allocate on the heap for nested messages<p>This is no longer the case if you use arenas: <a href="https:&#x2F;&#x2F;developers.google.com&#x2F;protocol-buffers&#x2F;docs&#x2F;reference&#x2F;arenas" rel="nofollow">https:&#x2F;&#x2F;developers.google.com&#x2F;protocol-buffers&#x2F;docs&#x2F;referenc...</a><p>&gt; and perhaps even for optional scalars<p>This has never been the case, except for string fields where std::string forces us to allocate.<p>Ideally we will eventually use std::string_view for string accessors instead of std::string, so that even string data can be allocated on an arena instead of the heap.')