Item(by='krapp', descendants=None, kids=None, score=None, time=1605226348, title=None, item_type='comment', url=None, parent=25071753, text='The Anarki codebase has diverged quite a bit from the Hacker News codebase, which itself has diverged from the default Arc language implementation, so searching Anarki to see how HN does things may not be useful much of the time, although much of the code is likely to be the same or similar simply due to how infrequently it changes.<p>Hacker News seems to have added unicode escaping on their own, as far as I know it&#x27;s not in either Anarki or the Arc forum.I assume HN just has a function strip unicode from comments while they&#x27;re being processed, based on a blacklist or killing everything outside of the ASCII range. That might happen in the general area of their version of process-story[0] in news.arc, but that&#x27;s just a guess on my part.<p>HTML generation and entity escaping are done in html.arc[1] and more or less just consist of escaping some entities. You might also check app.arc and server.arc.<p>Also, comments are stored as raw HTML in Arc tables in flat files, which implies there is no sanitizing of content being sent to the reader, except for downconverting to markdown and back when editing.<p>[0]<a href="https:&#x2F;&#x2F;github.com&#x2F;arclanguage&#x2F;anarki&#x2F;blob&#x2F;573e68332898233857da87ab5d986b25d8a45729&#x2F;apps&#x2F;news&#x2F;news.arc#L1555" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;arclanguage&#x2F;anarki&#x2F;blob&#x2F;573e6833289823385...</a><p>[1]<a href="https:&#x2F;&#x2F;github.com&#x2F;arclanguage&#x2F;anarki&#x2F;blob&#x2F;master&#x2F;lib&#x2F;html.arc#L76" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;arclanguage&#x2F;anarki&#x2F;blob&#x2F;master&#x2F;lib&#x2F;html.a...</a>')