Item(by='zX41ZdbW', descendants=None, kids=[25935389], score=None, time=1611754446, title=None, item_type='comment', url=None, parent=25926758, text='Using LZ4 can easily improve performance even if all data reside in memory.<p>This is the case in ClickHouse: if data is compressed, we decompress it in blocks that fit in CPU cache and then perform data processing inside cache; if data is uncompressed, larger amount of data is read from memory.<p>Strictly speaking, LZ4 data decompression (typically 3 GB&#x2F;sec) is slower than memcpy (typically 12 GB&#x2F;sec). But when using e.g. 128 CPU cores, LZ4 decompression will scale up to memory bandwidth (typically 150 GB&#x2F;sec) as well as memcpy. And memcpy is wasting more memory bandwidth by reading uncompressed data while LZ4 decompression reads compressed data.')