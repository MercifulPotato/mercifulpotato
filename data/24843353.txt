Item(by='kentonv', descendants=None, kids=[24851754, 24843406], score=None, time=1603236564, title=None, item_type='comment', url=None, parent=24843233, text='&gt; Doesn&#x27;t linux do shared-read-only mapping of pages on read(2) and only copy if you modify?<p>Eh? Do you have a reference for this? I&#x27;d be pretty interested to learn more.<p>This sounds like a very weird optimization to me, because, as you point out, it would only work if your buffer (and file offset) was page-aligned. That doesn&#x27;t happen by accident, so &quot;normal&quot; programs that use read() would almost never get a benefit. To get guaranteed page alignment, you probably have to use mmap() to allocate the buffer in the first place, so... why wouldn&#x27;t you just mmap the file, then?<p>In fact, you could arguably translate a page-aligned pread() into mmap() in userspace, using MAP_FIXED to force the mapping to be placed at your buffer address. No need for kernel help?<p>So why would a kernel implement this optimization? It seems like a lot of risk (of unexpected side effects) with little potential benefit.')