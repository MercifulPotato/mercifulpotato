Item(by='lipanski', descendants=None, kids=[25043381, 25040584], score=None, time=1604956427, title=None, item_type='comment', url=None, parent=25037293, text='In my experience, automatic eager loading is the most elegant solution to this problem. For ActiveRecord, I&#x27;d recommend Goliloader [1] (which is a gem similar to ar_lazy_preload but with emphasis on doing that automatically) while for Sequel, you can enable the TacticalEagerLoading plugin [2].<p>These tools don&#x27;t require explicit `includes`or `preload` calls. They can infer the tables that need to be eager loaded through usage (e.g. if you iterate through users and every iteration requests the user&#x27;s posts, the first iteration will eager load all posts for all those users). This fits really well with GraphQL because different clients might trigger requests for different associations. Automatic eager loading allows you to optimize for all those different cases without writing a single line of code.<p>The other solutions are either way too explicit or might be eager loading too much. Things like graphql-batch don&#x27;t even feel like ActiveRecord any more (and for a good reason - it&#x27;s a different kind of abstraction, meant to batch all sorts of things, including HTTP requests).<p>There are more caveats when it comes to eager loading, mainly there are many things that can break eager loading. I recently wrote a blog post [3] about dealing with those issues.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;salsify&#x2F;goldiloader" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;salsify&#x2F;goldiloader</a><p>[2] <a href="https:&#x2F;&#x2F;sequel.jeremyevans.net&#x2F;rdoc-plugins&#x2F;classes&#x2F;Sequel&#x2F;Plugins&#x2F;TacticalEagerLoading.html" rel="nofollow">https:&#x2F;&#x2F;sequel.jeremyevans.net&#x2F;rdoc-plugins&#x2F;classes&#x2F;Sequel&#x2F;P...</a><p>[3] <a href="https:&#x2F;&#x2F;lipanski.com&#x2F;posts&#x2F;activerecord-eager-loading" rel="nofollow">https:&#x2F;&#x2F;lipanski.com&#x2F;posts&#x2F;activerecord-eager-loading</a>')