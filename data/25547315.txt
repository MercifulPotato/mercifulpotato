Item(by='tanepiper', descendants=None, kids=[25547647], score=None, time=1609025378, title=None, item_type='comment', url=None, parent=25546460, text='A while back I wrote a opt-in tool called npl-lint[1] that would allow some CI-level enforcement of rules in package.json although I didn&#x27;t go too far with it - one thing was to check the scripts section and allow whitelisted apps, or whitelisted sources for dependencies.<p>It came about because I ended up having a spat with one of the NPM engineers at the time because they launched npx with the ability to run arbitrary gists[2] and this was before 2FA (FWIW you can still absolutely do this with npx).<p>I wrote a proof of concept[3] that showed you could, inside a package.json add a command to install another package from a gist location, and then use that to steal credentials, bash history, etc.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;tanepiper&#x2F;npm-lint" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;tanepiper&#x2F;npm-lint</a>\n[2] <a href="https:&#x2F;&#x2F;medium.com&#x2F;@maybekatz&#x2F;introducing-npx-an-npm-package-runner-55f7d4bd282b" rel="nofollow">https:&#x2F;&#x2F;medium.com&#x2F;@maybekatz&#x2F;introducing-npx-an-npm-package...</a>\n[3] <a href="https:&#x2F;&#x2F;github.com&#x2F;tanepiper&#x2F;steal-ur-stuff" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;tanepiper&#x2F;steal-ur-stuff</a>')