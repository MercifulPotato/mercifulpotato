Item(by='MrPowers', descendants=None, kids=[24872511], score=None, time=1603300427, title=None, item_type='comment', url=None, parent=24848241, text='I&#x27;d argue Koalas is an anti-pattern but will have to justify that in a blog post ;)<p>I&#x27;ve written some popular Scala Spark (<a href="https:&#x2F;&#x2F;github.com&#x2F;MrPowers&#x2F;spark-daria" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;MrPowers&#x2F;spark-daria</a>) and PySpark (<a href="https:&#x2F;&#x2F;github.com&#x2F;MrPowers&#x2F;quinn" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;MrPowers&#x2F;quinn</a>) libraries that have been adopted by a variety of teams.  Not sure how to make a reusable with pure SQL, but sounds like it&#x27;s possible.  Send me a code snippet or link if you have anything I can take a look at to learn more about your approach.')