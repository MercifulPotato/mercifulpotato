Item(by='barrkel', descendants=None, kids=[25596580], score=None, time=1609442060, title=None, item_type='comment', url=None, parent=25591492, text='The decoupling narrative is oversold for queues.<p>There&#x27;s essential decoupling and accidental decoupling; decoupling you want, and decoupling which mostly just obscures your business logic.<p>Resilience in the face of failure, where multiple systems are communicating, or there&#x27;s a lot of long-running work which you want to continue as seamlessly as possible, is the biggest essential decoupling. You externalize transitions in the state machine (edges in the state graph) of the logic as serialized messages, so you can blow away services and bring them back and the global state machine can continue.<p>Scaling from a single consumer to multiple consumers, from multiple CPUs to multiple machines, is mostly essential decoupling. Making decisions about how to parallelize subgraphs of your state machine, removing scaling bottlenecks, is an orthogonal problem to the correctness of the state machine on its own, and representing it as a state machine with messages in queues for edges helps with that orthogonality. You can scale things up without external persistent queues but you&#x27;ll end up with queues somewhere, even if it&#x27;s just worker queues for threads.<p>Accidental decoupling is where you have a complex state machine encapsulating a business procedure with multiple steps, and it&#x27;s coordinated as messages between and actions in multiple services. The business logic might say something like: take order from user; send email notification; complete billing steps; remove stock from inventory system; schedule delivery; dispatch stock; etc.<p>All this logic needs to complete, in sequence, but without higher order workflow systems which encode the state machine, a series of messages and producers and consumers is like so much assembly code hiding the logic. It&#x27;s easy to end up with the equivalent of COMEFROM code in a message system.<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;COMEFROM" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;COMEFROM</a>')