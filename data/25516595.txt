Item(by='ignoramous', descendants=None, kids=[25516606], score=None, time=1608723472, title=None, item_type='comment', url=None, parent=25516441, text='Not OP, but see <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=24848391" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=24848391</a><p>&gt; <i>The unlucky bit is WireGuard. XDP doesn&#x27;t really work on WireGuard; it only pretends to (with the &quot;xdpgeneric&quot; interface that runs in the TCP&#x2F;IP stack, after socket buffers are allocated). Among the problems: WireGuard doesn&#x27;t have link-layer headers, and XDP wants it to; the discrepancy jams up the socket code if you try to pass a packet with XDP_OK. We janked our way around this with XDP_REDIRECT, and Jason Donenfeld even wrote a patch, but the XDP developers were not enthused, just about the concept of XDP running on WireGuard at all, and so we ended up implementing the worker side of this in TC BPF.</i>')