Item(by='dragontamer', descendants=None, kids=None, score=None, time=1604707307, title=None, item_type='comment', url=None, parent=25011877, text='&gt; It’s also where you start hitting ray coherency problems - if you shoot 8 rays in a batch at roughly the same area of the scene, it’s likely that they’ll behave similarly. But as soon as they hit an object and bounce they all head in different directions, and pretty quickly you end up with dead lanes.<p>This is solved with stream compaction.<p><a href="http:&#x2F;&#x2F;www.cse.chalmers.se&#x2F;~uffe&#x2F;streamcompaction.pdf" rel="nofollow">http:&#x2F;&#x2F;www.cse.chalmers.se&#x2F;~uffe&#x2F;streamcompaction.pdf</a><p>There&#x27;s only two states you need to &quot;compact&quot; into:<p>* Hits -- These rays will &quot;recurse&quot; and continue bouncing.<p>* Miss -- These rays will sample the &quot;background&quot; (either a set color, or maybe a HDRI map or something).<p>Collect hits together through stream-compaction. Then collect misses together through stream-compaction. Once the &quot;hits&quot; queue is empty, process all Misses together.')