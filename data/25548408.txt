Item(by='klodolph', descendants=None, kids=[25549380], score=None, time=1609037667, title=None, item_type='comment', url=None, parent=25548114, text='This is fascinating. I can understand why the Homebrew devs might make the decision, but it seems the right way to do this is just to, e.g.,<p><pre><code>    cc -dM -E -xc &#x2F;dev&#x2F;null | less\n</code></pre>\nAnything with a preprocessor macro is supported on all OS configurations that you are targeting. You can see, for example, that __SSE4_1__ is defined, so SSE 4.1 is ok to use <i>without</i> checking it at runtime with e.g. sysctlbyname(&quot;hw.optional.sse4_1&quot;, &amp;enabled, ...)<p>I have always thought that it is worth a bit of paranoia to try and do the check for optional features the “correct” way, whatever method the OS advertises (like sysctl for macOS) rather than doing something like cpuid. After all, every once in a while it’s possible to run into a configuration where the CPU does support some particular feature but the OS does not, and if you rely on cpuid you could be up shit creek without a paddle.')