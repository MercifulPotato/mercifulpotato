Item(by='hpfr', descendants=None, kids=[25055606, 25055482], score=None, time=1605061275, title=None, item_type='comment', url=None, parent=25054753, text='If you have two, say, Microsoft accounts, can you use the same FIDO2-capable authenticator for both, and can Microsoft correlate the accounts by authenticator? I know keys are unique per-site, but are they per-account?<p>edit: The spec[1] is vague on this, but it <i>looked</i> like a Relying Party can&#x27;t correlate accounts directly via some kind of identifier for the authenticator. It looks like individual  key pairs are generated on the authenticator for each account and linked to the unique userEntity.ID given by the Relying Party. However, Mozilla warns you [2] when sites ask for additional information about your authenticator. I tested this with Yubico&#x27;s demo [3]. Unfortunately, it looks like the field attestationObject.attStmt.x5c identifies the authenticator. Firefox prompts you when sites ask for the extended information and removes this field if you check a box. That&#x27;s nice, I guess, but it still seems not so great. If you were to forget and use a user agent that didn&#x27;t prompt you to anonymize this, the Relying Party would get the attStmt in the response and theoretically could store and correlate accounts. Interested to hear more about the reasoning behind this.<p>edit 2: It looks like this field is necessary as a second factor when using passwordless login? On Yubico&#x27;s playground [4], checking &quot;Enable passwordless login with this key&quot; and then checking Firefox&#x27;s &quot;Anonymize anyway&quot; box results in no request made to the key. Without enabling passwordless login, the request still works after anonymizing.<p>To be honest, it seems like sites should allow passwordless login without the x5c field. I don&#x27;t see how an attacker couldn&#x27;t come up with the x5c field if they could crack the key pair. Is my reasoning right here?<p>1: <a href="https:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;webauthn-1" rel="nofollow">https:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;webauthn-1</a><p>2: <a href="https:&#x2F;&#x2F;support.mozilla.org&#x2F;en-US&#x2F;kb&#x2F;privacy-web-authentication" rel="nofollow">https:&#x2F;&#x2F;support.mozilla.org&#x2F;en-US&#x2F;kb&#x2F;privacy-web-authenticat...</a><p>3: <a href="https:&#x2F;&#x2F;demo.yubico.com&#x2F;webauthn-technical" rel="nofollow">https:&#x2F;&#x2F;demo.yubico.com&#x2F;webauthn-technical</a><p>4: <a href="https:&#x2F;&#x2F;demo.yubico.com&#x2F;playground" rel="nofollow">https:&#x2F;&#x2F;demo.yubico.com&#x2F;playground</a>')