Item(by='mbreese', descendants=None, kids=None, score=None, time=1610714766, title=None, item_type='comment', url=None, parent=25788976, text='I needed to add a persistent network configuration (which I didn&#x27;t really figure out -- I was okay with starting an interface manually. I also had to re-generate the SSH host keys for some reason.<p>In order to do these, I loaded the image in initramfs (basically started the VM w&#x2F;o specifying root=&#x2F;dev&#x2F;vda as the command line argument). Then I mounted &#x2F;dev&#x2F;vda and chroot&#x27;d to it. Then I could change the root password to something that I knew, and setup the keys &#x2F; config.<p>So, instead of tweaking the setup script, I ended up making the changes manually, but it should be scriptable.<p>I also was able to use the Ubuntu kernel&#x2F;initrd to load a Debian 10 image as well. The default Debian 10 cloud image doesn&#x27;t include the necessary kernel modules (virtio_console might be the only one necessary to add).<p>I&#x27;ve spent a few days testing out this and the linked vftool (<a href="https:&#x2F;&#x2F;github.com&#x2F;evansm7&#x2F;vftool" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;evansm7&#x2F;vftool</a>) to try to get a Debian VM. It&#x27;s not an easy thing, but it did eventually work. I ended up corrupting the disk image though, so that wasn&#x27;t fun.<p>In order to do this on my Mac w&#x2F;o needing a Linux machine, I installed ext4fuse so that I could mount raw disk images and mount partitions. I followed instructions from this GH issue, which was a great help.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;evansm7&#x2F;vftool&#x2F;issues&#x2F;2" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;evansm7&#x2F;vftool&#x2F;issues&#x2F;2</a>')