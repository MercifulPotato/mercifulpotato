Item(by='argomo', descendants=None, kids=None, score=None, time=1610392370, title=None, item_type='comment', url=None, parent=25730358, text='Give user agent two tokens: one for A and one for B (let&#x27;s call it UB). Pass UA and UB to A. A passes its own token to B plus the UB token. B uses user info from UB and roles from both UB and A&#x27;s token.<p>UB has a list of allowed intermediates (in this case, A) so user agent doesn&#x27;t send it to every service.<p>In my implementation there were various kinds of tokens, so UB couldn&#x27;t be used by itself to invoke B directly.<p>For our situation all this complexity turned out to be not worth it. :-&#x2F;')