Item(by='virtuallynathan', descendants=None, kids=[25414137, 25414448, 25414475, 25413358], score=None, time=1607916768, title=None, item_type='comment', url=None, parent=25413053, text='&quot;In observed traffic these HTTP response bodies attempt to appear like benign XML related to .NET assemblies, but command data is actually spread across the many GUID and HEX strings present. Commands are extracted from HTTP response bodies by searching for HEX strings using the following regular expression: &quot;\\{[0-9a-f-]{36}\\}&quot;|&quot;[0-9a-f]{32}&quot;|&quot;[0-9a-f]{16}&quot;. Command data is spread across multiple strings that are disguised as GUID and HEX strings. All matched substrings in the response are filtered for non HEX characters, joined together, and HEX-decoded. The first DWORD value shows the actual size of the message, followed immediately with the message, with optional additional junk bytes following. The extracted message is single-byte XOR decoded using the first byte of the message, and this is then DEFLATE decompressed. The first character is an ASCII integer that maps to the JobEngine enum, with optional additional command arguments delimited by space characters.&quot;<p>Dang, that&#x27;s pretty sneaky. This is one heck of a hack.')