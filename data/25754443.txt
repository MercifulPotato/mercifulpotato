Item(by='bostik', descendants=None, kids=[25754832, 25754739, 25754970], score=None, time=1610488561, title=None, item_type='comment', url=None, parent=25753773, text='&gt; <i>So how do we guard against this type of attack?</i><p>You can&#x27;t ever prevent it, but you can raise the attack cost&#x2F;complexity and make detection much more likely.<p>Go for immutable infra and transient CI&#x2F;CD systems. Provision the build nodes on demand, from trusted images, and wipe them out completely after just a few hours. The attacker will have to re-infect the nodes as they come online, and risk leaving more network traces. Anything they deploy on the systems goes away when the node goes away.<p>The attack against SolarWinds worked so well because the CI system was persistent and it was upgraded over time. For a reliable and secure environment, the correct amount of host configuration is zero: if you need to modify anything at all after a system has been launched, that&#x27;s a bad smell. Don&#x27;t upgrade. Provision a completely new system with the more recent versions.<p>This kind of architecture requires the attacker to compromise the CI image build and&#x2F;or storage instead. (Or the upstream, directly.) It&#x27;s an extra step for adversary, and a simpler point of control to the defender.<p>Recon. Compromise. Persist. Exfiltrate. -- As a defender you want to make every step as expensive and brittle as possible. You can&#x27;t prevent a compromise, but you can make it less useful, and you can arrange things so that it must happen often and leave enough traces to increase the probability of getting caught.')