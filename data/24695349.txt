Item(by='MauranKilom', descendants=None, kids=None, score=None, time=1601967880, title=None, item_type='comment', url=None, parent=24683067, text='Just to add the realization I had immediately after lying down: l &lt; s will of course be true for exactly one possible m per segment. All segments are shortened by s (or, equivalently, one &quot;hit&quot;).<p>This is therefore indeed just a performance optimization: The real check that is required to make all segments have the same number of possible m inside (and that is rejection-sampled around) is l &lt; t, but we don&#x27;t even need to compute t if l &gt;= s.<p>The algorithm would work fine if you completely removed the `if (l &lt; s) then` and `end if` lines, it would just compute a remainder more often. Significantly more often for small s.')