Item(by='notafraudster', descendants=None, kids=[25409009], score=None, time=1607881556, title=None, item_type='comment', url=None, parent=25398072, text='This is nifty but I don&#x27;t think implemented the way you&#x27;d want it to be.<p>You say you&#x27;re basing it -- or are inspired by -- the xkcd comic. But the xkcd comic gets this calculation more-or-less right. Entropy is not a property of the character set used to generate the password, it&#x27;s a property of the rule-set used to generate the password. Look at the comic: the &quot;Tr0ub4dor&amp;3&quot; password isn&#x27;t 11 random characters chosen from a set of 72 possibilities, and &quot;correct horse battery staple&quot; isn&#x27;t 28 characters chosen from lower alpha + space.<p>The difficulty in calculating password entropy is that it&#x27;s unclear whether or not the rule set will be known to the attacker or not. So an attacker which attempts &quot;arbitrary length lowercase characters&quot; will have a much harder time with &quot;correct horse battery staple&quot; than one that knows &quot;exactly four common english words in lowercase separated by spaces.&quot;<p>Or, put differently, if you know someone has a numeric four-character bank PIN and they submit 1979, do you think this was four randomly chosen digits or do you think the entropy is effectively reduced by an obvious ruleset used to generate it?<p>Because you rely on character set validation, except for your clever cheat to artificially reduce the entropy of repeated characters, you will nearly always overstate the entropy of the password.<p>A sort of very naive naive refinement of the problem is that you want an engine that, knowing a password, finds the feasible lowest entropy ruleset that could generate the password and is human reasonable. I include the qualifier &quot;feasible&quot; because via overfitting even random characters have a lowest entropy ruleset (e.g. if by chance the third character is capitalized and the 18th is not, we should not assume that the same rules applied again would generate this property) If you find this unsatisfying because the problem is open ended, I&#x27;d at least caution you that the entropy values as stated are at best an indication of how long it would take a brute-force character search to break the password, not how long it would take an even modestly informed adversary to do so.<p>Hope this guidance turns the cogs a little.')