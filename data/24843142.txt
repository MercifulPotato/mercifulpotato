Item(by='progval', descendants=None, kids=None, score=None, time=1603234603, title=None, item_type='comment', url=None, parent=24842306, text='From what I understand, when a user completes a captcha, you set a session cookie, using resty.session, which I assume is this library: <a href="https:&#x2F;&#x2F;github.com&#x2F;bungle&#x2F;lua-resty-session" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;bungle&#x2F;lua-resty-session</a><p>According to its readme, it does not check IP addresses, which means an attacker can just complete the CAPTCHA once, and copy their session to as many computers as they like. So you probably want to set session_check_addr.<p>But I&#x27;ve never used resty or lua, so I may be misreading how your code works.')