Item(by='jlokier', descendants=None, kids=[24802749], score=None, time=1602866848, title=None, item_type='comment', url=None, parent=24802500, text='System calls not packets.<p>By using sendmsg() with MSG_MORE instead of write(), you can avoid the setsockopt() with TCP_CORK to cork before the write, and the later setsockopt() with TCP_NODELAY to push despite the cork.<p>You can&#x27;t give MSG_MORE to sendfile(), though with HTTP you don&#x27;t need to.  But if you need an equivalent of MSG_MORE with sendfile() you can in theory use SPLICE_F_MORE with splice() instead.')