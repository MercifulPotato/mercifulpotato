Item(by='ignoramous', descendants=None, kids=[25237784], score=None, time=1606572668, title=None, item_type='comment', url=None, parent=25236057, text='root-cause tldr:<p><i>...[adding] new capacity [to the front-end fleet] had caused all of the servers in the [front-end] fleet to exceed the maximum number of threads allowed by an operating system configuration [number of threads spawned is directly proportional to number of servers in the fleet]. As this limit was being exceeded, cache construction was failing to complete and front-end servers were ending up with useless shard-maps that left them unable to route requests to back-end clusters.</i><p>fixes:<p>...moving to larger CPU and memory servers [and thus fewer front-end servers]. Having fewer servers means that each server maintains fewer threads.<p>...making a number of changes to radically improve the cold-start time for the front-end fleet.<p>...moving the  front-end server [shard-map] cache [that takes a long time to build, up to an hour sometimes?]  to a dedicated fleet.<p>...move a few large AWS services, like CloudWatch, to a separate, partitioned front-end fleet.<p>...accelerate the cellularization [0] of the front-end fleet to match what weâ€™ve done with the back-end.<p>[0] <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=swQbA4zub20" rel="nofollow">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=swQbA4zub20</a> and <a href="https:&#x2F;&#x2F;assets.amazon.science&#x2F;c4&#x2F;11&#x2F;de2606884b63bf4d95190a3c2390&#x2F;millions-of-tiny-databases.pdf" rel="nofollow">https:&#x2F;&#x2F;assets.amazon.science&#x2F;c4&#x2F;11&#x2F;de2606884b63bf4d95190a3c...</a>')