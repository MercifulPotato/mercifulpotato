Item(by='theptip', descendants=None, kids=[25350664], score=None, time=1607457080, title=None, item_type='comment', url=None, parent=25350241, text='Short answer: you write your consumer&#x27;s state into the same DB as you&#x27;re writing the side-effects to, in the same transaction.<p>Long answer: say your consumer is a service with a SQL DB -- if you want to process Event(offset=123), you need to 1. start a transaction, 2. write a record in your DB logging that you&#x27;ve consumed offset=123, 3. write your data for the side-effect, 4. commit your transaction. (Reverse 2 and 3 if you prefer; it shouldn&#x27;t make a difference). If your side-effect write fails (say your DB goes down) then your transaction will be broken, your side-effect won&#x27;t be readable outside the transaction, and the update to the consumer offset pointer also won&#x27;t get persisted. Next loop around on your consumer&#x27;s event loop, you&#x27;ll start at the same offset and retry the same transaction.')