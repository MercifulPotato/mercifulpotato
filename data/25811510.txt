Item(by='tialaramex', descendants=None, kids=None, score=None, time=1610897799, title=None, item_type='comment', url=None, parent=25811060, text='In WebAuthn (and U2F but that&#x27;s obsolete and you should just implement WebAuthn on a green field system) your credentials are inherently tied to an FQDN yes.<p>There are two tricks involved. Firstly, your web browser is co-opted to do this work. It knows this is news.ycombinator.com much better than you do. If this wasn&#x27;t in fact news.ycombinator.com, but looked correct and behaved as expected, you likely would not notice, but the browser checks the name matches for every single individual HTTP transaction.<p>So if the site fakebank.example tries to do a WebAuthn validation for realbank.example it just plain doesn&#x27;t work.<p>Next, for a Security Key or similar FIDO1 device, where you can enroll an unlimited number of sites on a single authenticator since they aren&#x27;t actually stored on the authenticator - the keys used are encrypted with that FQDN. So if bad guys stole your real authentication database enties at Real Bank (maybe from a backup) they not only can&#x27;t use them, they can&#x27;t even play them back to you and have you use them - they only work at all on the real site they were for, they&#x27;re just random garbage on any other site.<p>This relies on a two encryption technologies. 1. Public Key Signatures (mostly using elliptic curves but that isn&#x27;t essential). I can pick two related numbers, tell you one, and then in future you can challenge me to prove I know the other one on different occasions, and you&#x27;ll know I do even though you don&#x27;t learn the number. Your Security Key can prove to GitHub that it is still the same Security Key that visited before, despite GitHub not knowing which one that is.<p>2. AEAD Authenticated Encryption. Modern symmetric encryption not only keeps your data confidential, it can also simultaneously authenticate it, your Security Key knows when given back an encrypted &quot;ID&quot; that it&#x27;s a real one it issued to this web site, because random IDs will fail the authentication step.<p><i>Either</i> of these tricks would arguably achieve our basic security goals, but they are both adding further strengths to the system, so why not have both.<p>[Edited to clarify some details]')