Item(by='ChuckMcM', descendants=None, kids=None, score=None, time=1605297232, title=None, item_type='comment', url=None, parent=25083153, text='Query per second or qps limits is a good start, but I quickly learned that a 1qps limit to &quot;free&quot; access meant that all of a sudden it was a 1000 unique IPs that were making one request each.<p>Lots of botnets were highlighted this way, when one address searches for &#x27;joomla v2.3&#x27;, and the next IP searches for &#x27;joomla v2.3&#x27;, page=2, and the next IP searches for &#x27;joomla v2.3&#x27;, page=3, etc.<p>It was annoying but an interesting problem. We could implement any arbitrary policy and then watch as the bots adjusted to come in just at that policy limit. We banned entire Ukrainian ISPs (they were a big source at the time) and have VPN providers become the big users. We put in limits per day, I tried a &quot;thermal&quot; system where IPs gained &quot;heat&quot; by queries and &quot;cooled&quot; by idle time. We built a server with a &quot;broken&quot; IP stack that we could send the initial TCP connect to, the server would accept the connection and then never respond. A &quot;black hole&quot; if you will. The trick was we didn&#x27;t actually keep[ sockets open we just pretended like we it was the other end of a TCP connection. It did everything correctly except complete the connection. That would cause any client using off the shelf IP stacks to hang indefinitely.<p>It is a game with no ending as one might say.')