Item(by='danidiaz', descendants=None, kids=[25088871], score=None, time=1605308056, title=None, item_type='comment', url=None, parent=25087948, text='The only way to get hold of a DArray is inside the callback of the &quot;alloc&quot; function:<p><pre><code>     alloc :: Int -&gt; (DArray a ⊸ ()) ⊸ Array a\n</code></pre>\nAccording to the linear Haskell paper: &quot;f :: s ⊸ t guarantees that if (f u) is consumed exactly once, then the argument u is consumed exactly once.&quot; Also: &quot;To consume a pair exactly once, pattern-match on it, and consume each component exactly once&quot;<p>So, if we call splitDArray inside that callback, then we are obliged to consume each of the resulting  (DArray a, DArray a) exactly once to satisfy the constraint that the input is consumed exactly once.')