Item(by='btown', descendants=None, kids=None, score=None, time=1605223873, title=None, item_type='comment', url=None, parent=25076454, text='I think it&#x27;s an exaggeration to say that it&#x27;s impossible to keep local AV databases up to date in a meaningful way.<p>Use compressed probabilistic data structures and ship minimal diffs to save bandwidth and storage; you can fall back to phoning home if there&#x27;s a possibility of a collision with a known-bad hash. Apple&#x27;s solved push messages at scale; it could piggyback an update mechanism on that, or use the techniques Dropbox uses to notify about file updates. It can do this at the OS level so there&#x27;s no threat of a user process not being active to pull updates. And the check is already soft-failing (per the OP) so it won&#x27;t break if the system is offline, so they&#x27;re already not caring about threats that are so new, they were found while the computer was offline.<p>You need to solve a lot of timing diagrams and race conditions (and, if we&#x27;re being snarky, maybe it&#x27;s for the best that Apple isn&#x27;t trying to do this!) but it should be doable.')