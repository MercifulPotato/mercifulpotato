Item(by='nerpderp82', descendants=None, kids=None, score=None, time=1611868854, title=None, item_type='comment', url=None, parent=25949051, text='I often use a pattern where I do a batch and group a bunch of operations baked into a tuple that describes the computation. Instead of do_thing(on_data), the intermediate pass would emit a data structure full of list([(&quot;operation_do_a_thing&quot;, on_data), ... ] and then a command executor can do the actual scheduling of the operations, serial, parallel, batched, try&#x2F;except with backpressure, etc.<p>Separate the thing you want done from the doing it, because when you intermingle the doing-the-thing it greatly complications the scheduling logic. Think of it as a working  programmers io monad.')