Item(by='kxyvr', descendants=None, kids=[25066636], score=None, time=1605135668, title=None, item_type='comment', url=None, parent=25063627, text='I&#x27;ll have a look at Catamari and thanks for the link.  Maybe you&#x27;ll have a better idea, but essentially I need a generalized inverse of AA&#x27; where A has more columns than rows (short and fat.)  Often, A becomes underdetermined enough where AA&#x27; no longer has full-rank, but I need a generalized inverse nonetheless.  If A&#x27; was full rank, then the R in the QR factorization of A&#x27; is upper triangular.  If A&#x27; is not full rank, but we can permute the columns, so that  the R in the QR factorization of A&#x27; has the form [RR S] where RR is upper triangular and S is rectangular, we can still find the generalized inverse.  As far as I know, the permutation that ensures this form requires a rank-revealing QR factorization.<p>For dense matrices, I believe GEQP3 in LAPACK pivots so that the diagonal elements of R are decreasing, so we can just threshold and figure out when to cut things off.  For sparse, the only code I&#x27;ve tried that&#x27;s done this properly is SPQR with its rank-revealing features.<p>In truth, there may be a better way to do this, so I might as well ask: Is there a good way to find the generalized inverse of AA&#x27; where A is rank-deficient as well as short and fat?<p>As far as where they come from, it&#x27;s related to finding minimum norm solutions to Ax=b even when A is rank-deficient.  In my case, I know the solution exists for a given b, even though the solution may not exist in general.')