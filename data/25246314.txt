Item(by='rwmj', descendants=None, kids=None, score=None, time=1606669111, title=None, item_type='comment', url=None, parent=25246263, text='You could probably build something easily in nbdkit to do this.  (Note this is at the block layer).  An advantage of nbdkit is you could write the whole thing in the high-level language of your choice, even a scripting language such as Python, which might make it easier to rapidly explore designs.<p>Having said that I did try to implement a deduplication layer for nbdkit, but what I found was that it wasn&#x27;t very effective.  It turns out that duplicate data in typical VM filesystems isn&#x27;t common, and the other parts of the filesystem (block free lists etc) were not sufficiently similar to deduplicate given my somewhat naive approach.')