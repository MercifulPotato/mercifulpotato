Item(by='davidhyde', descendants=None, kids=[25667860, 25659948, 25657290], score=None, time=1609934608, title=None, item_type='comment', url=None, parent=25656583, text='I find window functions to be an excellent way to find the max version of a set of things. The trick is to partition by some columns (similar to how you would use a group by), order by descending on your version number field, and use the row_number() function which is very lightweight. Then you filter for all entries where rownumber = 1 and voila you have the max version without having to link back on yourself!')