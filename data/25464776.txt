Item(by='teraflop', descendants=None, kids=None, score=None, time=1608277311, title=None, item_type='comment', url=None, parent=25464324, text='&gt; What&#x27;s the reason that it can&#x27;t act like a filesystem image, and keep everything in one file?<p>I suspect it&#x27;s mostly because putting everything into one file instead of two isn&#x27;t really necessary for most use cases, and it would significantly complicate the implementation.<p>The main SQLite database file is organized into numbered fixed-size pages, which are used to store B-tree nodes. The B-tree structure itself is fairly complex, but the journal file format is extremely simple: it&#x27;s essentially just a list of page indices along with their old contents. (WAL mode is very similar, except that the new contents are stored instead. See <a href="https:&#x2F;&#x2F;sqlite.org&#x2F;fileformat2.html" rel="nofollow">https:&#x2F;&#x2F;sqlite.org&#x2F;fileformat2.html</a> for the details.)<p>The catch is that both the database and the journal need to be independently resizable. So if you wanted to store them both in a single file, you would need to either reserve a fixed amount of space for the journal up front, or allow the journal and&#x2F;or the database itself to become fragmented across different byte ranges of the file. The latter option would require you to keep track of an extra layer of indirection to know where the journal data is stored, and that metadata would itself need to be efficiently, atomically updateable.<p>Essentially, you would be building an entire rudimentary filesystem just to store two logical files in one physical one, when the OS already has a perfectly good filesystem available for you to use.')