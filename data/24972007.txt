Item(by='jeff-davis', descendants=None, kids=[24973123], score=None, time=1604345207, title=None, item_type='comment', url=None, parent=24969025, text='But to organize memory you need some idea of how much you are using (e.g. how big the in-memory hash table is), and be able to free it in a reasonable pattern (e.g. deallocate the whole heap&#x2F;arena at once). Both things are difficult in rust currently, and memory mapping doesn&#x27;t help with either.<p>Memory mapping serves a similar purpose as temp files: a way to tell the OS that it can freely page that out to avoid uncontrolled swapping. But you need to do the organization yourself to keep that access sequential, which is hard to do in rust for the reasons that I mentioned.<p>If you memory map a hash table and have memory pressure, you&#x27;ll go into the crazy bad scenario of a page-in for every lookup, which is avoidable with better organization.<p>I think we are basically in agreement but perhaps my point was not clear.')