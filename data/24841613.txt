Item(by='vardump', descendants=None, kids=None, score=None, time=1603223162, title=None, item_type='comment', url=None, parent=24840226, text='Good point.<p>In that case you might for example need to splice about 8-16 kB substrings to UTF-8 validate, to strike a reasonable balance between loop setup costs etc. and <i>not</i> spilling L1 cache. You&#x27;d of course need to check every splice ends at a valid UTF-8 boundary.<p>Streaming operation composition while <i>not</i> sacrificing memory bandwidth or excessive overhead for CPU&#x27;s liking is pretty cumbersome. You definitely don&#x27;t want to spill cache, but you also need avoid overhead by ensuring vectorized code can take full advantage of the CPU performance.<p>Anyone who tries to achieve high performance in this kind of operations without a profiler is doomed.')