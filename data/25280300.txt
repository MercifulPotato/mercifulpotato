Item(by='burntsushi', descendants=None, kids=None, score=None, time=1606936914, title=None, item_type='comment', url=None, parent=25279996, text='&gt; In the currently stable version, the main interface of each &quot;adapter&quot; is `fn(Read, Write) -&gt; ()`. To allow custom adapter chaining I have to change it to be `fn(Read) -&gt; Read` where each chained adapter wraps the read stream and converts it while reading. But then I get issues with how to handle threading etc, as well as a random deadlock that I haven&#x27;t figured out how to solve so far :&#x2F;<p>I don&#x27;t quite grok the problem here. If you file an issue against ripgrep proper with code links and some more details, I can try to assist.<p>Taken literally, ripgrep uses that exact same approach. There are potentially multiple adapters being used. Each adapter is just defined to wrap a `std::io::Read` implementation, and the adapter in turn implements `std::io::Read` so that it can be composed with others. The part that I&#x27;m missing is why this has anything to do with threading or deadlocks. I&#x2F;O adapters shouldn&#x27;t be having anything to do with synchronization. So I&#x27;m probably misunderstanding your problem.')