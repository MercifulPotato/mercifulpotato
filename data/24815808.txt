Item(by='aszen', descendants=None, kids=[24816322], score=None, time=1603000682, title=None, item_type='comment', url=None, parent=24813795, text='I had a narrow escape once doing something fancy with migrations.<p>We had several MySQL string columns as long text type in our database but they should have been varchar(255) or so. So I was assigned to convert these columns to their appropriate size.<p>Being the good developer I was, I decided to download a snapshot of the prod database locally and checked the maximum string length we had for each column via a script. Using this script it made a migration query that would alter column types to match their maximum used length keeping the minimum length as varchar (255).<p>I tested that migration and everything looked good, it passed code review and was run on prod. Soon after we start getting complaints from users that their old email texts have been truncated. I then realize the stupidity of the whole thing, the local dump of production database always wiped out many columns clean for privacy like the email body column. So the script thought it had max length of 0 and decided to convert the column to varchar(255).<p>I realize the whole thing may look incredibly stupid, that&#x27;s only because the naming for db columns was in a foreign european language so I didn&#x27;t know even know the semantics of each column.<p>Thankfully my seniors managed to restore that column and took the responsibility themselves since they had passed the review.<p>We still did fix those unusually large columns but this time by simple duplicate alter queries for each of those columns instead of using fancy scripts.<p>I think a valuable lesson was learned that day to not rely on hacky scripts just to reduce some duplicate code.<p>I now prefer clarity and explicitness when writing such scripts instead of trying to be too clever and automating everything.')