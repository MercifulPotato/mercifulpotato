Item(by='kllrnohj', descendants=None, kids=None, score=None, time=1606320782, title=None, item_type='comment', url=None, parent=25207536, text='&gt; On recent Apple Silicon CPUs uncontended most atomic operations are essentially free - almost identical in speed to the non-atomic version of the same operation.<p>They are fast for atomics but still far, far slower than the equivalent non-atomic operation. An add operation takes around half a cycle (upper bound here - with how wide the firestorm core is an add operation is almost certainly less than half a cycle). At 1ghz a cycle is 1 nanosecond. The M1 runs at around 3ghz. So you&#x27;re still talking the atomic operation being &gt;10x slower than non-atomics.<p>Which should not be surprising at all. Apple didn&#x27;t somehow invent literal magic here. They still need coherency across 8 cores, which means at a minimum L1 is bypassed for the atomic operation. The L2 latency is very impressive, contributing substantially to that atomic operation performance. But it&#x27;s still coming at a very significant cost. It&#x27;s very, very far from free. There&#x27;s also no ARM vs. x86 difference here, since the atomic necessarily forces a specific memory ordering guarantee that&#x27;s stricter than x86&#x27;s default. Both ISAs are forced to do the same thing and pay the same costs.')