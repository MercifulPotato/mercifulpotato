Item(by='Spivak', descendants=None, kids=[25350293], score=None, time=1607448933, title=None, item_type='comment', url=None, parent=25346851, text='I feel like the inventory thing is a bit of a straw-man because the situation is set out in such a way that you need transactions for it to work. If you find yourself wishing you had a global write-lock on a topic to then of course it won&#x27;t work. Modeling your data for Kafka is work just the same as it is for MySQL. Of course it might not be the best tool for the job but you should at least give it a fair shake.<p>You should be able to post &quot;buy&quot; messages to a topic without fear that it messes up your data integrity. Who cares if two people are fighting over the last item? You have a durable log. Post both &quot;buys&quot; and wait for the &quot;confirm&quot; message from a consumer that&#x27;s reading the log at that point in time, validates, and confirms or rejects the buys. At the point that the buy reaches a consumer there is enough information to know for sure whether it&#x27;s valid or not. Both of the buy events happened and should be recorded whether they can be fulfilled or not.')