Item(by='Thorrez', descendants=None, kids=[25185128], score=None, time=1606122751, title=None, item_type='comment', url=None, parent=25184324, text='Good point. But it seems like it would require usage like this:<p><pre><code>    int* p = malloc(sizeof(int));\n    FREE(&amp;p);\n</code></pre>\nWhat if we instead define the macro like this:<p><pre><code>    #define FREE(ptr) do { \\\n        __typeof__(ptr)* const __x = &amp;(ptr); \\\n        free(*__x); *__x = NULL; \\\n    } while(0)\n</code></pre>\nThen make usage slightly shorter, as well as more similar to free():<p><pre><code>    int* p = malloc(sizeof(int));\n    FREE(p);</code></pre>')