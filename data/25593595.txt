Item(by='genghizkhan', descendants=None, kids=None, score=None, time=1609429107, title=None, item_type='comment', url=None, parent=25593105, text='Edit: Sorry, I just realised what you mean. I don&#x27;t know about iptables, but I&#x27;ve got nftables set to come up before the network is set up and it works perfectly fine without enp3s0 or wg0 having come up. The rules are set and then the interfaces come up.<p>Original comment follows:<p>I&#x27;m... not sure I understand. VPNs would only work after your physical interfaces are up, right? So if you want your firewall rules to be applied before a VPN interface comes up then you&#x27;d be perfectly fine with network-pre. From the page I linked in the comment you replied to:<p>&quot;network-pre.target is a target that may be used to order services before any network interface is configured. Its primary purpose is for usage with firewall services that want to establish a firewall before any network interface is up. It&#x27;s a passive unit: you cannot start it directly and it is not pulled in by the the network management service, but by the service that wants to run before it. Network management services hence should set After=network-pre.target, but avoid any Wants=network-pre.target or even Requires=network-pre.target. Services that want to be run before the network is configured should place Before=network-pre.target and also set Wants=network-pre.target to pull it in. This way, unless there&#x27;s actually a service that needs to be ordered before the network is up the target is not pulled in, hence avoiding any unnecessary synchronization point.&quot;<p>So ideally you&#x27;d run your VPN service after network-online.target has been reached, which would certainly be after the firewall rules have been applied.<p>The great thing about persistent interface names is that if you know the names of the interfaces which are going to be coming up, then you can set up a firewall before any of them come up. Which takes care of dynamic VLAN interfaces. You can use IP addresses or blocks to refer to them in your firewall config, am I right?<p>If you think I&#x27;m unable to grasp your situation, can you give me a more detailed example?')