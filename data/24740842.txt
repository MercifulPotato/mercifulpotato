Item(by='chubot', descendants=None, kids=[24741734], score=None, time=1602354513, title=None, item_type='comment', url=None, parent=24727495, text='I&#x27;m working on fixing errexit &#x2F; set -e in Oil:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;oilshell&#x2F;oil&#x2F;issues&#x2F;709" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;oilshell&#x2F;oil&#x2F;issues&#x2F;709</a><p>Summary of problems:<p>1. The &quot;if myfunc&quot; problem -- error checking is skipped.  This is specified by POSIX, but it&#x27;s undesirable.<p>2.  The f() { test -d &#x2F;tmp &amp;&amp; echo &quot;exists&quot; } problem.  The exit code of the function is probably not what you expect!<p>3. the local x=$(false) problem.  This happens in all shells because of the definition of $?.  (local is a shell builtin with its own exit code, not part of the language)  This one is already fixed with shopt -s more_errexit in Oil.<p>4. the x=$(false) problem.   This is a bash problem with command substitution.  For example, dash and zsh don&#x27;t have this problem.  Test case:<p><pre><code>    bash -c &#x27;set -e; x=$(false); echo should not get here&#x27;\n</code></pre>\nNewer versions of bash fix it with inherit_errexit.  Oil also implements inherit_errexit and turns it on by default!  (in Oil, not OSH)<p>-----<p>So 1 and 2 relate to the confusing combination of shell functions and errexit.<p>And 3 and 4 relate to command subs.  Oil has fixed these with opt-in OSH shell options (on by default in Oil), but not 1 and 2.<p>If you know of any other problems, please chime in on the bug!')