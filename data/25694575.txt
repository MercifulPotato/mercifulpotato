Item(by='chrisseaton', descendants=None, kids=[25694681], score=None, time=1610155487, title=None, item_type='comment', url=None, parent=25694466, text='&gt; But for the single threaded version I still seen spikes across all cores is this some CPU magic and if so what techniques are involved?<p>The kernel must be moving the Ruby process around if you&#x27;re looking at the single-threaded case. That doesn&#x27;t sound right though - moving a process to a different core damages its cache. But Ruby doesn&#x27;t influence that it&#x27;s down to the OS. Maybe the kernel has some subtle good reason to do it if you&#x27;re running other services in the background?<p>&gt; What do you mean by this?<p>Ractors acquire locks and CAS to do things to update the VM on what they&#x27;re doing. They don&#x27;t run entirely purely in parallel. GC is the big example. This benchmark shouldn&#x27;t really need to use the GC... but maybe it does. Does your system malloc have a global lock too?')