Item(by='gigatexal', descendants=None, kids=None, score=None, time=1602024756, title=None, item_type='comment', url=None, parent=24698660, text='Here’s a Redshift oddity that I don’t think is documented:<p>select sum(y.a), count(y.a) from(select distinct x.a from ( select 1 as a union all select  2 as a union all select 1 as a)x)y<p>sum | count \n-----+-------\n   4 |     3<p>Sqlite3 returns the correct results of sum of 3 count of 2.<p>To fix this don’t use subqueries.')