Item(by='hodgesrm', descendants=None, kids=[25349878], score=None, time=1607453319, title=None, item_type='comment', url=None, parent=25349511, text='I would just put the ledger in a database table if it&#x27;s that important and maintain the current state of the account in a separate table. ACID transactions and database constraints make this kind of consistency easier to achieve than many alternatives. It&#x27;s also easier to prove correctness since you can run queries that return consistent results thanks to the isolation guaranteed by ACID. (Modulo some corner cases that are not hard to work around.)<p>Just my $0.02.')