Item(by='scottlamb', descendants=None, kids=None, score=None, time=1603243288, title=None, item_type='comment', url=None, parent=24843511, text='Also, even when io_uring does copying in kernelspace, I wonder if it&#x27;d be more practical for it to use AVX instructions than from within a read syscall.<p>As I understand it, userspace&lt;-&gt;kernel transitions are lighter-weight than full context switches between processes. As discussed here: not saving&#x2F;restoring the SIMD registers. (I think a bunch of other ways, too, like not replacing all the memory mappings.)<p>There are also a bunch of pure-kernel processes (I don&#x27;t know the terminology) shown on ps in square brackets, like [kthreadd], [rcu_gp], [rcu_par_gp], etc. I think a full context switch happens on entry&#x2F;exit to one of these, just as between two different userspace processes. If the io_uring work always happens within one of these (does it?), the SIMD registers are already being saved&#x2F;restored, and it&#x27;d be safe for it to use an avx_memcpy variant without paying any additional cost.')