Item(by='skissane', descendants=None, kids=None, score=None, time=1606584576, title=None, item_type='comment', url=None, parent=25237419, text='&gt; But if you delete a file in an archive, you must either rewrite the archive (since you can&#x27;t &quot;move&quot; bytes in a file), or accept that disk space will be wasted.<p>Another option is to tell the operating system to deallocate part of the file, turning it into a sparse file. This can be done with fallocate(FALLOC_FL_PUNCH_HOLE) on Linux, FSCTL_SET_ZERO_DATA on Windows.<p>Linux also has fallocate(FALLOC_FL_COLLAPSE_SIZE) which lets you actually remove a byte range from the middle of a file, shifting up everything that comes after that byte range. So, in fact, you can &quot;move&quot; bytes in a file, on certain filesystems on Linux (ext4, xfs, among others).<p>Unfortunately, support for sparse files is quite variable across platforms. The macOS equivalent to fallocate(FALLOC_FL_PUNCH_HOLE) if fcntl(F_PUNCHHOLE), but the issue is HFS+ has never supported sparse files. UFS did, but UFS support was dropped from 10.7 onwards. The support is supposed to be back in APFS, but I don&#x27;t know if it actually works.')