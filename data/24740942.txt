Item(by='dalke', descendants=None, kids=[24741531], score=None, time=1602355389, title=None, item_type='comment', url=None, parent=24740151, text='Sorry, I see how what I wrote could be interpreted that way, and part of what I wrote was out of ignorance. While I didn&#x27;t write it, I assumed the macro was doing some sort of equivalent to the template metaprogramming I&#x27;ve heard about in C++ to do similar things.<p>What I did&#x27;t see was how I could use the AVX2 instructions myself.<p>Checking now, since Julia&#x27;s count_ones() maps to the LLVM popcount instruction, and recent clang versions know how to optimize that fixed-length sequence in C even for AVX-512, the Julia equivalent to the code I wrote should have good performance.<p>There are a few optimizations (keeping one AVX register loaded with a constant byte string, and using prefetch instructions) which might be missing. I&#x27;ll be talking with the conference participant who brought up Julia to work this out in more detail.<p>Thanks for the comment!')