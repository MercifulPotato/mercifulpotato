Item(by='throwaway189262', descendants=None, kids=None, score=None, time=1606296909, title=None, item_type='comment', url=None, parent=25196547, text='You can store &quot;possible attacking&quot; IP&#x27;s in a counting Bloom filter and start blocking when it saturates. Random false positives are probably not an issue for an analytics service that&#x27;s inherently lossy anyways.<p>By using Bloom filter you avoid storing IP&#x27;s, and save tons of space. They&#x27;re basically required for rate limiting in IPV6 where the address space is so large an attacker can just run you out of ram by using so many different IP&#x27;s.<p>It&#x27;s also pretty common to have several thresholds of blocking based on individual IP vs subnets. So if more than 2 ips get blocked in a small subnet, you block the whole subnet.')