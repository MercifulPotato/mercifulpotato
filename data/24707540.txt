Item(by='wtallis', descendants=None, kids=[24708307], score=None, time=1602074121, title=None, item_type='comment', url=None, parent=24706435, text='&gt; So it couldn&#x27;t possibly be made secure before 2015<p>You&#x27;re wildly misunderstanding things. Up to 2015, it was <i>possible</i> to build a new PC that lacked the necessary hardware features, primarily by choosing one of Intel&#x27;s enthusiast-oriented overclockable CPU models (which used to have the IOMMU disabled for product segmentation reasons). But it was still very much possible to get all the necessary hardware features by selecting the next slower speed grade of the same chip, or by buying almost any pre-built system equipped with Thunderbolt ports. And since then, it&#x27;s been almost <i>impossible</i> to build a PC that lacks the necessary hardware security features, because pretty much the only Intel CPUs still in production that lack IOMMU capabilities are Atom parts which aren&#x27;t socketed and probably aren&#x27;t used in any Thunderbolt-capable machines.<p>&gt; Wikipedia seems to state no OS has managed to do so (as of 2019). Thunderbolt had been around since 2011.<p>You should read more carefully, and preferably follow the link to the source paper. That paper points out how Mac OS X started using the IOMMU to protect against DMA attacks in 2012, Linux and FreeBSD likewise have such capabilities, Windows pretty much doesn&#x27;t (no longer true).<p>The point of that paper cited on Wikipedia was to show that when operating systems poke holes in the IOMMU protection to allow certain devices to perform DMA, it&#x27;s possible to open up a more exploitable hole than you might expect. In particular, data structures may need to be rearranged to align with the 4kB page protection granularity, or else information that should remain inaccessible to peripherals may be exposed alongside legitimate DMA payload. And it&#x27;s also possible for a malicious device to spoof the device IDs of a trusted device type and be granted access by default, but that&#x27;s a class of vulnerability that exists for plain old USB, too.<p>So as I originally stated, the IOMMU is the hardware feature needed to block DMA attacks. But it&#x27;s only effective when used properly by the OS. That&#x27;s not trivialâ€”but also not impossible.')