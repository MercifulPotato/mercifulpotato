Item(by='daanx', descendants=None, kids=None, score=None, time=1606069818, title=None, item_type='comment', url=None, parent=25179627, text='Ah, I think Stephen meant to write the following:<p><pre><code>  fun add-refs( a : ref&lt;h,int&gt;, b : ref&lt;h,int&gt; ) : st&lt;h&gt; int {\n    a := 10\n    b := 20\n    (!a + !b)\n  }\n</code></pre>\nwhere indeed the effect is `st&lt;h&gt;` as the updates are observable. How the function was written before, the two arguments use a &quot;rank-2&quot; polymorphic type and the heaps are fully abstract -- in that case it would be unobservable but you cannot create such values :-)')