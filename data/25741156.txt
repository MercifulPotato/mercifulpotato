Item(by='rubyfan', descendants=None, kids=None, score=None, time=1610415450, title=None, item_type='comment', url=None, parent=25740327, text='Same, the difference I had in my implementation was an added an 8 week moving average. This worked for most of the year and I think even holidays. What was considered normal for the week of Thanksgiving would not be considered normal for a summer week. This was relatively easy using SQL CTEs and windowing functions.<p>I also separately used a package in R called bsts (Bayesian Structural Time Series) for a different way of projecting seasonality on a trend to find an acceptable normal range. If the actual fell out of range then it was an anomaly. Great write up on the technique by Kim Larsen here: <a href="https:&#x2F;&#x2F;multithreaded.stitchfix.com&#x2F;blog&#x2F;2016&#x2F;04&#x2F;21&#x2F;forget-arima&#x2F;" rel="nofollow">https:&#x2F;&#x2F;multithreaded.stitchfix.com&#x2F;blog&#x2F;2016&#x2F;04&#x2F;21&#x2F;forget-a...</a>')