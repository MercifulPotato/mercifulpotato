Item(by='nh2', descendants=None, kids=None, score=None, time=1605354458, title=None, item_type='comment', url=None, parent=25091582, text='That is also the most important part to me. But I don&#x27;t understand it. It says:<p>&gt; I was also (incorrectly) assuming that renaming a file after having fsynced the contents is a valid mechanism<p>Where does anyone say that this doesn&#x27;t work?<p>I read the article twice and it suggests that open+write+fsync+close+dir-fsync is safe (&quot;We&#x27;ve now seen what we have to do to write a file safely&quot;).<p>I&#x27;ve also read the reference &quot;Bornholt et al., ASPLOSâ€™16&quot; mentioned in the &quot;Rename&quot; section; it says &quot;One possible fix is to add an fsync(fd)&quot;. I cannot find another place in that paper that says otherwise. The later analysed Atomic-replace-via-rename (ARVR) and Atomic-create-via-rename (ACVR) approaches <i>skip</i> the fsync.<p>That said, user &quot;tfha&quot; replied to your linked thread<p>&gt; I can confirm experimentally that the rename trick is not good enough.<p>but unfortunately without any data on whether the directory was fsynced, or on which file system.<p>So I&#x27;d like to ask again:<p>Is there any evidence that open+write+fsync+close+dir-fsync does not work?')