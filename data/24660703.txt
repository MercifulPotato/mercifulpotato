Item(by='sillysaurusx', descendants=None, kids=None, score=None, time=1601630738, title=None, item_type='comment', url=None, parent=24660350, text='<p><pre><code>    let shape = [1,-1,1,1];\n    # line up shapes.\n    mean = nn.reshape(mean, shape)\n    variance = nn.reshape(variance, shape)\n    scale = nn.reshape(scale, shape)\n    bias = nn.reshape(bias, shape)\n    # calculate 1&#x2F;sqrt(variance); add an epsilon to prevent dividing by 0\n    epsilon = nn.constant(epsilon)\n    inv_var = nn.rsqrt(nn.add(variance, epsilon))\n    # batchnorm, I think?\n    x = nn.sub(input, mean),\n    x = nn.mul(x, inv_var)\n    x = nn.mul(x, scale)\n    x = nn.add(x, bias);\n    return x\n</code></pre>\nI don&#x27;t know why they didn&#x27;t use nn.rsqrt, since it&#x27;s a common operation. In fact it&#x27;s so common it&#x27;s a builtin op: <a href="https:&#x2F;&#x2F;www.tensorflow.org&#x2F;api_docs&#x2F;python&#x2F;tf&#x2F;raw_ops&#x2F;Rsqrt" rel="nofollow">https:&#x2F;&#x2F;www.tensorflow.org&#x2F;api_docs&#x2F;python&#x2F;tf&#x2F;raw_ops&#x2F;Rsqrt</a><p>I&#x27;m skeptical the reshaping is even necessary. Any reasonable framework should broadcast those shapes automatically.')