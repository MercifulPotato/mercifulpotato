Item(by='wodenokoto', descendants=None, kids=[24845796, 24846436, 24845767, 24846112], score=None, time=1603267071, title=None, item_type='comment', url=None, parent=24845300, text='When working directly with SQL instead of an ORM, how do you elegantly handle things like parameterizing table names or having flags that turns on or off filters?<p>In non-ORM codebasese I am seeing patterns where sql queries are &quot;copy-pasted&quot; together and I am not sure I like it.<p>Just imagine the following example had hundreds of lines of SQL and several optional filters, some of which could themselves be several lines long:<p><pre><code>    def get_data(table1, table1, use_subset=True):\n        if use_subset:\n            filter_query = &quot;AND column2=&quot;subset_value&quot;\n        else:\n            filter_query = &quot;&quot;\n\n        query = f&quot;&quot;&quot;\n        SELECT \n          * \n        FROM\n          {table1}\n        JOIN\n          {table2}\n        WHERE\n           column1=&quot;value&quot;\n           {filter_query}\n        &quot;&quot;&quot;</code></pre>')