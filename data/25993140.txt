Item(by='kmill', descendants=None, kids=None, score=None, time=1612210252, title=None, item_type='comment', url=None, parent=25989092, text='I did this to see how it was as a practical functional programming language, and I find I like the syntax and typeclass system more than Haskell&#x27;s.  One neat feature is that do notation had mut variables and for loops that get compiled to folds automatically. It also has Idris-style arrow notation for binding inside pure expressions.  (It&#x27;s also really easy to compile to C!)<p>The Lean runtime implements the Perseus algorithm for functional in-place updating when possible. It&#x27;s a very clever reimagining of reference counting from basic principles.  The loop that combines all the results from all the threads takes advantage of this and doesn&#x27;t allocate intermediate arrays.')