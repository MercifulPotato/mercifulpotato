Item(by='TheDong', descendants=None, kids=[25187941], score=None, time=1606094424, title=None, item_type='comment', url=None, parent=25180961, text='And written to be less readable with e.g.:<p><pre><code>    return bytes.ReplaceAll(script, []byte{0x09}, []byte{0x20, 0x20, 0x20, 0x20})\n</code></pre>\ninstead of<p><pre><code>    bytes.ReplaceAll(script, []byte(&quot;\\t&quot;), []byte(&quot;    &quot;))\n</code></pre>\nSkimming through the code, there&#x27;s a lot of other pretty basic mistakes.<p>The most egregious is that the use of a python script has a security issue. Let&#x27;s see if you can spot it, it&#x27;s in these lines:<p><pre><code>    tmp := fmt.Sprintf(&quot;&#x2F;var&#x2F;tmp&#x2F;invertpdf--%s&#x2F;&quot;, time.Now().Format(&quot;20060102150405&quot;))\n    os.Mkdir(tmp, 0700)\n    WriteText(tmp+&quot;pngtopdf.py&quot;, GetPDFConv())\n    &#x2F;&#x2F; later execute that .py file\n</code></pre>\nSo, what&#x27;s the issue? Well, using a predictable temporary directory and then not checking for an error in `mkdir` means that an attacker can easily create that directory before you do (especially since it&#x27;s a predictable name based on the time), and then write their own python script. That lets another user on your machine run arbitrary code as your user.<p>&quot;But&quot;, you might say, &quot;WriteText does an os.Exit if it can&#x27;t write the file&quot;. That doesn&#x27;t matter. If i create the directory with permissions 777, and then have a program waiting for the python script to be written in order to replace it with a malicious script, Mkdir will error (dir already exists), but WriteText will succeed, and so the vulnerability still happens.<p>This is the sort of dumb vulnerability you get if you don&#x27;t know that `ioutil.TempDir` exists (or don&#x27;t know about symlink races, tmpdir races, etc). `ioutil.TempDir(&quot;&#x2F;var&#x2F;tmp&quot;, &quot;invertpdf-<i></i><i></i>&quot;)` would be the more secure way to do this, though obviously you still should check that error too.<p>There&#x27;s a lot of other problems with this program, but this vulnerability is the most obvious.')