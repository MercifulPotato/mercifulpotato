Item(by='wzk86651', descendants=None, kids=None, score=None, time=1602192016, title=None, item_type='comment', url=None, parent=24718972, text='... and std channels still contain data races:<p><pre><code>  cat src&#x2F;main.rs \n\n  fn main() {\n      let (tx1, rx1) = std::sync::mpsc::sync_channel::&lt;std::sync::mpsc::Receiver&lt;_&gt;&gt;(0);\n      let (tx2, rx2) = std::sync::mpsc::sync_channel::&lt;std::sync::mpsc::Sender&lt;_&gt;&gt;(0);\n\n      std::thread::spawn(move || {\n          for rx in rx1 {\n              let _ = rx.recv_timeout(std::time::Duration::new(0, 0));\n          }\n      });\n      std::thread::spawn(move || {\n          for tx in rx2 {\n              let _ = tx.clone();\n          }\n      });\n\n      loop {\n          let (tx, rx) = std::sync::mpsc::channel::&lt;String&gt;();\n          tx1.send(rx).unwrap();\n          tx2.send(tx).unwrap();\n      }\n  }\n\n  RUSTFLAGS=-Zsanitizer=thread cargo run -Z build-std --target x86_64-unknown-linux-gnu\n  ==================\n  WARNING: ThreadSanitizer: data race\n  ...\n  SUMMARY: ThreadSanitizer: data race in std::sync::mpsc::shared::Packet$LT$T$GT$::drop_port::hb1e2c47df4539855</code></pre>')