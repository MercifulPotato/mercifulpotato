Item(by='chriswarbo', descendants=None, kids=None, score=None, time=1603708545, title=None, item_type='comment', url=None, parent=24894344, text='I&#x27;ve also used macros to execute some expensive data processing at compile-time. I had a fixed dataset containing named sets of strings, and I wanted a program which reads in a set of strings and returns the names of any supersets which appear in the dataset. For example, if the dataset contains &#x27;x = {a, b, c}&#x27;, &#x27;y = {a, b, d}&#x27; and &#x27;z = {a, c, d, e}&#x27; then a query of &#x27;{a, c}&#x27; should return &#x27;{x, z}&#x27;.<p>I managed to speed this up a lot by using a (TemplateHaskell) macro to (a) read in the dataset from an external file at compile time, (b) transform it into a structure that has fast lookups and (c) serialise that structure to a Haskell syntax tree. Not only did this make lookups faster at runtime, it also eliminated all the error checking for locating&#x2F;reading&#x2F;parsing&#x2F;etc. of the dataset: any problem would cause a compile error; if compilation succeeded, the resulting program didn&#x27;t have to know or care about any of that.')