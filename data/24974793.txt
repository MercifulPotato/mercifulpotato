Item(by='MauranKilom', descendants=None, kids=None, score=None, time=1604360653, title=None, item_type='comment', url=None, parent=24974743, text='Wonder no longer!<p><a href="https:&#x2F;&#x2F;godbolt.org&#x2F;z&#x2F;M4TKb7" rel="nofollow">https:&#x2F;&#x2F;godbolt.org&#x2F;z&#x2F;M4TKb7</a><p>While this may look disappointing, it should be clear that adding 5% (or even 0.1%) error to inverse square root calculations is not something compilers are in the business of.<p>Now, when you give the compiler more leeway (and -ffast-math is <i>substantial</i> leeway for anything less ephemeral than triangle normals on screen), you get much more interesting things:<p><a href="https:&#x2F;&#x2F;godbolt.org&#x2F;z&#x2F;85zG5r" rel="nofollow">https:&#x2F;&#x2F;godbolt.org&#x2F;z&#x2F;85zG5r</a><p>Turns out x86 has a (microcoded) instruction for this (and newer processors also have vectorized versions[1] of it). The compiler adds Newton-Rhapson for good measure.<p>[1]: <a href="https:&#x2F;&#x2F;uops.info&#x2F;html-lat&#x2F;KBL&#x2F;VRSQRTSS_XMM_XMM_XMM-Measurements.html" rel="nofollow">https:&#x2F;&#x2F;uops.info&#x2F;html-lat&#x2F;KBL&#x2F;VRSQRTSS_XMM_XMM_XMM-Measurem...</a>')