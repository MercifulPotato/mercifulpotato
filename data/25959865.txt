Item(by='tanelpoder', descendants=None, kids=[25960243], score=None, time=1611941344, title=None, item_type='comment', url=None, parent=25959534, text='Thanks for the &quot;hwloc&quot; tip. I hadn&#x27;t thought about that.<p>I was thinking of doing something like that. Weirdly I got sustained throughput differences when I killed &amp; restarted fio. So, if I got 11M IOPS, it stayed at that level until I killed fio &amp; restarted. If I got 10.8M next, it stayed like it until I killed &amp; restarted it.<p>This makes me think that I&#x27;m hitting some PCIe&#x2F;memory bottleneck, dependent on process placement (which process happens to need to move data across infinity fabric due to accessing data through a &quot;remote&quot; PCIe root complex or something like that). But then I realized that Zen 2 has a central IO hub again, so there shouldn&#x27;t be a &quot;far edge of I&#x2F;O&quot; like on current gen Intel CPUs (?)<p>But there&#x27;s definitely some workload placement and I&#x2F;O-memory-interrupt affinity that I&#x27;ve wanted to look into. I could even enable the NUMA-like-mode from BIOS, but again with Zen 2, the memory access goes through the central infinity-fabric chip too, I understand, so not sure if there&#x27;s any value in trying to achieve memory locality for individual chiplets on this platform (?)')