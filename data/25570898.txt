Item(by='Blikkentrekker', descendants=None, kids=None, score=None, time=1609257074, title=None, item_type='comment', url=None, parent=25566198, text='Yes, it doesn&#x27;t do it there on optimization level 2, however it does do it here for instance:<p><pre><code>    import System.IO.Unsafe\n\n    debug x = unsafePerformIO $ print x &gt;&gt; pure x\n\n    map1 = map $ debug . (+ 1)\n    map2 = map $ debug . (* 2)\n\n    main = let\n      list      = [1,2,3,4,5,6]\n      newlist   = map1 list\n      newerlist = map2 newlist\n      in print newerlist\n</code></pre>\nThe output of this is:<p><pre><code>      2\n      4\n      3\n      6\n      4\n      8\n      5\n      10\n      6\n      12\n      7\n      14\n      [4,6,8,10,12,14]\n</code></pre>\nShowing that it was smart enough to traverse once.<p>If `map1` and `map2` were imported by some library, it would be close to impossible to speak of maintaining stable a.b.i.&#x27;s to both these functions without the compiler somehow being able to turn them inside out and traverse only once.')