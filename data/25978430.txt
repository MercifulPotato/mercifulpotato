Item(by='tialaramex', descendants=None, kids=None, score=None, time=1612097499, title=None, item_type='comment', url=None, parent=25971222, text='&gt; Middleboxes by design MITM connections.<p>If only this was true. Almost all of TLS 1.3 would be more straight forward if you were right. As a trivial example, clients could begin by saying they want to speak TLS 1.3 rather than pretending they want TLS 1.2 even though they actually don&#x27;t.<p>Implementing a security device as back-to-back proxy in which there are two connections, one from a client to the device, then another from the device to the server, would be entirely compliant with the standard, it would trivially enable forward compatibility, and it would make it easier to reason about the provided security features (if any).<p>But it would make them (much) more expensive.<p>The true purpose of such middleboxes is not security, it is to transfer money from gullible customers to the vendor. &quot;Security&quot; is just an excuse, if they thought you&#x27;d buy it to prevent COVID-19 that&#x27;s what they would claim it does.<p>So, a common trick went like this: When a client makes an HTTPS connection, you let it ride, but you passively watch the first few packets they receive. You&#x27;re looking for the X.509 certificate from the server, which you will then inspect to figure out if it&#x27;s somebody you trust. If not, you reset the connection and next time they try you intercept, perhaps to display a &quot;Warning: Unauthorized Terror Porn Gay Propaganda Web Site. Your Boss Has Been Notified&quot; message.<p>Notice this doesn&#x27;t actually provide any security at all, X.509 certificates are public documents, my servers can give you the certificate for Google, or a local hospital, or PornHub, even though I am not in fact Google, a local hospital or PornHub. The middlebox won&#x27;t know this was bogus because the protocol only proves the server knows the keys for this certificate to the <i>client</i> not a third party eavesdropping.<p>But this &quot;trick&quot; <i>does</i> break TLS 1.3 as originally designed because since a plaintext X.509 certificate is only useful for snooping and provides no security benefit it is now encrypted, and these middleboxes would freak out.<p>So what was done about that? Well they don&#x27;t actually provide any security so we just sidestepped it. TLS 1.3 claims to be a TLS 1.2 resumption. &quot;Oh you were already talking to this server about something else. I&#x27;m sure I must have checked that time and it was fine. On you go&quot; says the middlebox.<p>This worked very well for their actual purpose, as you can see from the revenues of middlebox suppliers.')