Item(by='chubot', descendants=None, kids=None, score=None, time=1603514223, title=None, item_type='comment', url=None, parent=24876138, text='A bunch of points:<p>(1) <i>Except when your tokens can contain newlines, which we&#x27;re stuck with for the foreseeable future.</i> -- not sure what you mean here, because QSN strings are defined not to contain literal newlines.  They&#x27;re escaped like &#x27;\\n&#x27;.<p>The invariant of QSN is: EVERY BYTE STRING, including those with newlines and nuls, can be represented on a single line.  I guess I should put this in the documentation.<p>(2) A QSN decoder is very easy to write.  For example, here&#x27;s a ~6 line regex that validates all of QSN:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;oilshell&#x2F;oil&#x2F;blob&#x2F;master&#x2F;qsn_&#x2F;qsn.py#L498" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;oilshell&#x2F;oil&#x2F;blob&#x2F;master&#x2F;qsn_&#x2F;qsn.py#L498</a><p>True, you need like ~20 lines of code to decode it, but that&#x27;s very easy too.  You can also  make a QSN decoder from a JSON string decoder.  It&#x27;s basically changing your tests and moving a few statements around.<p>(And yes, QSN is a regular language [1])<p>(3) Oil should grow [2] an awk-like dialect [3] that understands QSN and QTSV.<p>(4) Although you also don&#x27;t have to decode it for it to be useful.<p>1. I can use wc -l on a stream of QSN strings<p>2. If I know the strings are QSN-encoded, I can search for NUL bytes with fgrep &#x27;\\0&#x27;<p>It&#x27;s basically like the UTF-8 philosophy.  ASCII is valid utf-8.  QSN lines are lines of text.<p>(5) base64 is bad for humans at the terminal, because it makes everything unreadable.  QSN preserves all printable ASCII and unicode.<p>-----<p>I don&#x27;t think it&#x27;s going to solve all problems, but it will solve some.  It&#x27;s there if you need it.  In typical Unix style, the solutions will be heterogeneous.  You can absolutely use the NUL format in Oil, and it now has support for it.<p>[1] <a href="http:&#x2F;&#x2F;www.oilshell.org&#x2F;blog&#x2F;2020&#x2F;07&#x2F;eggex-theory.html" rel="nofollow">http:&#x2F;&#x2F;www.oilshell.org&#x2F;blog&#x2F;2020&#x2F;07&#x2F;eggex-theory.html</a><p>[2] That is, if I get help :)<p>[3] <a href="http:&#x2F;&#x2F;www.oilshell.org&#x2F;blog&#x2F;tags.html?tag=awk#awk" rel="nofollow">http:&#x2F;&#x2F;www.oilshell.org&#x2F;blog&#x2F;tags.html?tag=awk#awk</a>')