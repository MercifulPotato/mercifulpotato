Item(by='alexott', descendants=None, kids=None, score=None, time=1606581397, title=None, item_type='comment', url=None, parent=25234973, text='libmagic is quite primitive and can&#x27;t reliably handle the complex data types, like, MS Office documents with embedded objects (especially the versions before 2007), files with common container types (jar&#x2F;war files are detected just as zip), etc. - the signature language is quite primitive from my point of view.  Plus it&#x27;s quite slow...<p>I&#x27;ve spent a long time (&gt; 10 years) developing code for detection of file types (without relying onto the file extension), and extraction of the data... And everything was need to be done very fast &amp; reliably. The last project was the content detection for the filtering web proxy, where every millisecond counts. And for signatures, there was a lisp-like language that allowed to describe very complex detection rules, although it&#x27;s sometime was still necessary to go to the C++, for things like, OLE2 parsing, XML parsing, or listing files in Zip files, etc.<p>From the open source alternatives, it makes sense to look to the Apache Tika that has both content detection &amp; extraction capabilities, although it&#x27;s written in Java...')