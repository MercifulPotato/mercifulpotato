Item(by='perbu', descendants=None, kids=[25884354, 25883901, 25887896, 25883872, 25885623, 25885482], score=None, time=1611420225, title=None, item_type='comment', url=None, parent=25881911, text='The author notices that Bolt doesn&#x27;t use mmap for writes. The reason is surprisingly simple, once you know how it works. Say you want to overwrite a page at some locations that isn&#x27;t present in memory. You&#x27;d write to it and you&#x27;d think that is that. But when this happens the CPU triggers a page fault, the OS steps in and reads the underlying page into memory. It then relinquishes control back to the application. The application then continues to overwrite that page.<p>So for each write that isn&#x27;t mapped into memory you&#x27;ll trigger a read. Bad.<p>Early versions of Varnish Cache struggled with this and this was the reason they made a malloc-based backend instead. mmaps are great for reads, but you really shouldn&#x27;t write through them.')