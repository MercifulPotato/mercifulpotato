Item(by='sebcat', descendants=None, kids=None, score=None, time=1606466721, title=None, item_type='comment', url=None, parent=25223702, text='Apart from Linux hw support for things at work, I implemented a fairly simple pseudo-device for establishing TCP connections from a process in capability mode on FreeBSD. The device driver has support for a denylist to disallow connections to specific IP ranges. It has multiple syscalls wrapped into one ioctl, and sockets opened from the device always had TCP_NODELAY, O_CLOEXEC and SOCK_NONBLOCK set. Worked pretty well for its intended use case.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;sebcat&#x2F;yans&#x2F;blob&#x2F;master&#x2F;drivers&#x2F;freebsd&#x2F;tcpsrc&#x2F;tcpsrc.4.txt" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;sebcat&#x2F;yans&#x2F;blob&#x2F;master&#x2F;drivers&#x2F;freebsd&#x2F;t...</a>\n<a href="https:&#x2F;&#x2F;github.com&#x2F;sebcat&#x2F;yans&#x2F;blob&#x2F;master&#x2F;drivers&#x2F;freebsd&#x2F;tcpsrc&#x2F;tcpsrc.c" rel="nofollow">https:&#x2F;&#x2F;github.com&#x2F;sebcat&#x2F;yans&#x2F;blob&#x2F;master&#x2F;drivers&#x2F;freebsd&#x2F;t...</a>')