Item(by='hawkar20', descendants=None, kids=None, score=None, time=1603457594, title=None, item_type='comment', url=None, parent=24866378, text='I like what you&#x27;ve done here. I&#x27;ve personally gone down the route of using SQLAlchemy to build queries. The primary reason is that SQLAlchemy lets me build up reuseable SQL elements, to encapsulate business logic, like metrics and custom dimensions in Python. In particular SQLAlchemy&#x27;s hybrid expressions, that allow you to tie an SQL expression to a ORM model are super useful for doing this sort of thing. There&#x27;s also first class support for CTEs, window functions and other advanced SQL features. For me there&#x27;s just something &quot;dirty&quot; about using raw SQL in code, or even templating it, even with security concerns like injection attacks put aside.<p>I second the recommendation for dbt. Especially if you&#x27;re following an ELT architecture where you load your data into a data warehouse and then want to transform it. However dbt is more useful for transforming existing data, or aggregating data in batches. It&#x27;s not a tool for generating SQL expressions on-the-fly like your library would allow you to do.')