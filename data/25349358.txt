Item(by='fiddlerwoaroof', descendants=None, kids=[25351084, 25350682], score=None, time=1607451986, title=None, item_type='comment', url=None, parent=25348735, text='Well, it’s more complicated, but in theory you could do some deep packet inspection that understands the protocols: personally, I’d use this to break DoH connections (for every host name seen in SNI, attempt a DoH query, if it resolves, reset the connection) and attempt to force everything to fall back to plain DNS. Then, whitelist a couple outbound ports (on most networks, maybe just 443 + 53?) and block VPNs.')