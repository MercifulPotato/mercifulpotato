Item(by='api', descendants=None, kids=[25570652, 25570648, 25578488], score=None, time=1609254928, title=None, item_type='comment', url=None, parent=25570077, text='There&#x27;s plenty of room if the IPv4 header to extend it.<p>The most significant bit of the IP protocol number field is mostly unused. The IP protocols that use it could be safely deprecated on the open Internet.<p>Setting the MSB indicates a 64-bit address.<p>In 64-bit mode the source IP and destination IP fields in the V4 header become the most significant 32 bits of the source and destination IP. The least significant 32 bits of each are present in the options field, which contains enough room for both. In 64-bit mode any other use of the options field is deprecated. The bit index of these 32-bit chunks in the options field could be standardized to permit easy hardware decoding. The part of the options that indicate the option type and length could be present for backward compatibility with IP64-unaware routers but otherwise ignored.<p>Uglier than a clean slate design? Sure, a bit. But if this had been done, we&#x27;d already be using it everywhere and the problem would be solved.<p>TCP, UDP, and other IP protocols could remain almost entirely unchanged, though I imagine tables in software stacks would have to be extended to support 64 bits of address space. That&#x27;s not a major change.<p>I just came up with that in 10 minutes while replying to this post. I assume it would take a committee several years to write the above spec.<p>The big &quot;win&quot; here is that existing IPv4 routers in the Internet&#x27;s core infrastructure do not need to be upgraded all at once. They&#x27;d just lack the ability to understand anything beyond &#x2F;32.<p>Honestly there are probably enough &#x2F;32&#x27;s to give one to every <i>major</i> endpoint, so I wonder if the core would even need to worry about it at all. I imagine that ISPs would hand out &#x2F;32&#x27;s to business customers (maybe for an additional fee), but once IP64 were widely deployed they&#x27;d probably hand out &#x2F;48&#x27;s to most subscribers. That would give you 65,535 &quot;real&quot; IP addresses for your house or small business. Mobile phones might get a &#x2F;56, which would give them 256 IPs for tethering and permit cellular networks some additional IP space.<p>There are nice things about 128-bit addresses, but I am not sure they are worth adding 30+ years to the transition and having to lug around the hideous boat anchor that is NAT for an extra few decades.')