Item(by='jeroenhd', descendants=None, kids=None, score=None, time=1607773892, title=None, item_type='comment', url=None, parent=25397625, text='You&#x27;re right if this was some included third party script, but usually these hacks involve an attacker getting access to the (PHP&#x2F;HTML) source code and injecting stuff directly. At that point there&#x27;s very little you can do to prevent JS files from being changed or the CSP being disabled at all. Very few web store systems rely on statically generated HTML pages, and the ones that do usually have some JS file for animations or functionality that the attacker can also modify.<p>CSP is great for blocking XSS and other such attacks, but I don&#x27;t think it can be an effective defence in this particular attack. The only way I can think of to get CSP to protect you is to host no JS on the server itself, configure some kind of proxy (Cloudflare?) and inject CSP config there. An attacker could still compromise the website but they&#x27;d need to escalate their attack to the point of a DNS takeover or add a noticeable redirect to an attacker-controlled skimming page, both of which aren&#x27;t very likely to be used against random targets like these web shops often are.')