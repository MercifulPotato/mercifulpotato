Item(by='CodesInChaos', descendants=None, kids=None, score=None, time=1606331415, title=None, item_type='comment', url=None, parent=25212473, text='End-to-end MACs don&#x27;t help because the recipient knows the key and thus can generate a valid MAC on a fake message.<p>But there are plenty of other ways to implement this. Digital signatures. Or if facebook stores the ciphertext, the recipient could simply reveal the decryption key for the message. Or facebook could compute a MAC over the ciphertext with a key neither participant knows, then the recipient could reveal the ciphertext and decryption key, and facebook could verify the outer MAC to verify authenticity.')