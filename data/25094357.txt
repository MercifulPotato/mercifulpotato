Item(by='nneonneo', descendants=None, kids=None, score=None, time=1605378503, title=None, item_type='comment', url=None, parent=25093688, text='At the very start I actually built the binary using the usual strategy of including a big DOS stub, but it wouldn’t load on Windows 10. I’m not entirely sure why, but I believe it’s because the next_offset value in the MZ header was too big - &gt;= 4096 would make it fail. So I resorted to stuffing the PE header inside the MZ header after suitably expanding it.')