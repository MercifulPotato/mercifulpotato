Item(by='ncmncm', descendants=None, kids=None, score=None, time=1607097210, title=None, item_type='comment', url=None, parent=25281377, text='Use of instructions that compilers have great difficulty (usefully) generating, for various reasons, is a common theme lately.<p>In this case, prefetch, which to be useful often requires a context switch.<p>Another, lately, is popcount.<p>One that only appears in very recent Intel (and AMD?) is an instruction to sleep until a particular cache line gets invalidated, as a way to both save on power and latency, as waking up can be faster than escaping the poorly-branch-predicted spin loop.<p>There are various appalling tricks to keep your branch predictor from killing your loop escape latency.')