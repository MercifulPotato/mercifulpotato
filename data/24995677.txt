Item(by='mjgs', descendants=None, kids=None, score=None, time=1604550818, title=None, item_type='comment', url=None, parent=24993357, text='I think we’re getting pretty close to understanding the root cause.<p>Tools that you run in actions can trigger the stdout commands (setting env variables and a few others) via printing to the console.<p>To do some damage though they need a few other things to happen. The example given is a node process that is run after the attacker has set an env variable with arbitrary code, which node reads and executes.<p>Additionally since some actions print the contents of PRs and Issues to the console, these can effectively do the same thing. So the attacker doesn’t need to control a cli tool stdout output, they just need to\ncreate a PR&#x2F;Issue with the malicious code. If an automated workflow writes the PR&#x2F;Issue to stdout, then the malicious code in the PR&#x2F;Issue is executed.<p>Since it’s possible for any action to run commands by writing to stdout, you have to trust that all the actions you use don’t print malicious stuff to stdout, and they themselves might not be malicious, but they might print stupid stuff that contains untrusted input like the contents of PRs&#x2F;Issues.<p>It’s not made any easier by the fact that the workflows are in the repo for the attacker to read and study, so they can see exactly what will happen before their attack.<p>This whole method of triggering commands via stdout is very dodgy, and there is no way to either turn it off, or narrow the scope of what is executed, and it’s not easy to see what happened after the fact either.<p>At the minute you just have to be very diligent at checking that your actions aren’t printing stupid stuff to stdout that could cause execution of malicious code later in your workflow.<p>If it’s only the setting of env variables that causes issues, then they might be able to just turn that off because there is another safer mechanism (writing to $GITHUB_ENV) to set env variables.<p>There might very well be other attack surfaces though that I haven’t thought of.')