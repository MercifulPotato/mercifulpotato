Item(by='PoignardAzur', descendants=None, kids=None, score=None, time=1607033262, title=None, item_type='comment', url=None, parent=25294255, text='The instruction this is based on is prefetch; which is essentially the only relevant instruction when doing manual cache optimization on x86&#x2F;x64.<p>It&#x27;s not a panacea though; naive usage of prefetch will actually <i>decrease</i> performance [0], because the hardware already does a lot of prefetching on its own and you&#x27;re messing with that.<p>From what little research I&#x27;ve done, prefetch mostly improves performance when accessing data in a hot loop, in a non-linear pattern (eg nextAddress isn&#x27;t just prevAdress + constantValue), 3-4 loop iterations ahead of the execution. Eg<p><pre><code>    doThings(myArrayOfPointers[i]);\n    __builtin_prefetch(myArrayOfPointers[i + 4]);\n</code></pre>\n(though the above code might be undefined behavior if i + 4 is bigger than the array size, I&#x27;m not sure)<p>[0]: <a href="https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;444336&#x2F;" rel="nofollow">https:&#x2F;&#x2F;lwn.net&#x2F;Articles&#x2F;444336&#x2F;</a>')